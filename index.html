<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-11-11 mié 22:04 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Análisis numérico</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Jhon, Samuel, Alejandro" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<style>pre.src{background:#343131;color:white;} </style>
<style> #content{max-width:1800px;}</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Análisis numérico</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org49315d1">1. Métodos de la primera entrega.</a>
<ul>
<li><a href="#org527b6db">1.1. Solución de ecuaciones de una variable</a>
<ul>
<li><a href="#org890a45a">1.1.1. Bisección</a></li>
<li><a href="#orgd006637">1.1.2. Búsquedas incrementales</a></li>
<li><a href="#orgfd62e19">1.1.3. Regla falsa</a></li>
<li><a href="#org51f00ca">1.1.4. Punto fijo</a></li>
<li><a href="#orgdefa9af">1.1.5. Newton</a></li>
<li><a href="#orgd0d5cad">1.1.6. Secante</a></li>
<li><a href="#org09995cd">1.1.7. Raíces múltiples</a></li>
</ul>
</li>
<li><a href="#org488808e">1.2. Solución de sistemas de ecuaciones lineales</a>
<ul>
<li><a href="#org2062df8">1.2.1. Eliminación gaussiana</a></li>
<li><a href="#org7cee8c2">1.2.2. Pivoteo parcial</a></li>
<li><a href="#org97b7c81">1.2.3. Pivoteo total</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org529ee42">2. Métodos de la segunda entrega</a>
<ul>
<li><a href="#orgb2a76b8">2.1. Solución de sistemas de ecuaciones lineales</a>
<ul>
<li><a href="#org6b3595d">2.1.1. LU con gaussiana simple, Lu con pivoteo parcial</a></li>
<li><a href="#org0c8e9b6">2.1.2. Crout, Doolittle, Cholesky</a></li>
<li><a href="#org651464f">2.1.3. Jacobi</a></li>
<li><a href="#org2f751d2">2.1.4. Gauss-Seidel, SOR</a></li>
<li><a href="#org02bc5bd">2.1.5. Vandermonde</a></li>
</ul>
</li>
<li><a href="#orgbcecbff">2.2. Interpolación</a>
<ul>
<li><a href="#org90f23e0">2.2.1. Newton</a></li>
<li><a href="#org44b6e2b">2.2.2. Lagrange</a></li>
<li><a href="#orge28cf76">2.2.3. Trazadores lineales</a></li>
<li><a href="#org5c73a3d">2.2.4. Trazadores cuadráticos</a></li>
<li><a href="#org4bfd353">2.2.5. Trazadores cúbicos</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>



<div id="outline-container-org49315d1" class="outline-2">
<h2 id="org49315d1"><span class="section-number-2">1</span> Métodos de la primera entrega.</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org527b6db" class="outline-3">
<h3 id="org527b6db"><span class="section-number-3">1.1</span> Solución de ecuaciones de una variable</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org890a45a" class="outline-4">
<h4 id="org890a45a"><span class="section-number-4">1.1.1</span> Bisección</h4>
<div class="outline-text-4" id="text-1-1-1">
<ul class="org-ul">
<li><p>
Como ejecutar:
</p>
<pre class="example">
biseccion(0,1,0.0000001,100,"log(sin(x)**2 + 1) - 1/2")
</pre></li>

<li><p>
Algoritmo y resultados.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> math 
<span style="color: #c397d8;">from</span> py_expression_eval <span style="color: #c397d8;">import</span> Parser

<span style="color: #e78c45;">parser</span> = Parser()

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">biseccion</span>(xInferior, xSuperior, tolerancia, maximoIteraciones, f):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = [] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxInferior = f(xInferior)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxInferior</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xInferior})
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxSuperior = f(xSuperior)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxSuperior</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xSuperior})

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fxInferior == 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xInferior) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> fxSuperior == 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xSuperior) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> fxInferior * fxSuperior &lt; 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> = 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xMedio</span> = (xInferior + xSuperior) / 2
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxMedio = f(xMedio)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxMedio</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xMedio})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, xInferior, xSuperior, xMedio, fxMedio, 0]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = tolerancia + 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">while</span> error &gt; tolerancia <span style="color: #c397d8;">and</span> fxMedio != 0 <span style="color: #c397d8;">and</span> contadorIteraciones &lt; maximoIteraciones:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fxInferior * fxMedio &lt; 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xSuperior</span> = xMedio
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxSuperior</span> = fxMedio

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xInferior</span> = xMedio
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxInferior</span> = fxMedio

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">auxiliar</span> = xMedio

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xMedio</span> = (xInferior + xSuperior) / 2
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxMedio = f(xMedio)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxMedio</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xMedio})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = <span style="color: #70c0b1;">abs</span>(xMedio - auxiliar)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, xInferior, xSuperior, xMedio, fxMedio, error]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fxMedio == 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xMedio) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> error &lt; tolerancia:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xMedio) + <span style="color: #b9ca4a;">" es una aproximacion a una raiz con una tolerancia = "</span> + <span style="color: #70c0b1;">str</span>(tolerancia), <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Fracaso en "</span> + <span style="color: #70c0b1;">str</span>(maximoIteraciones) + <span style="color: #b9ca4a;">" iteraciones."</span>, <span style="color: #70c0b1;">False</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"El intervalo es inadecuado."</span>, <span style="color: #70c0b1;">False</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [tabla, mensaje] 

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">main</span>():
<span style="background-color: #2a2a2a;"> </span>  <span style="color: #e78c45;">a</span> = biseccion(0,1,0.0000001,100,<span style="color: #b9ca4a;">"log(sin(x)**2 + 1) - 1/2"</span>)
<span style="background-color: #2a2a2a;"> </span>  <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'\n'</span>)
<span style="background-color: #2a2a2a;"> </span>  <span style="color: #c397d8;">print</span>(a)

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   main()

</pre>
</div>
<pre class="example">
 #+RESULTS:
: 
: [[[1, 0, 1, 0.5, -0.2931087267313766, 0], [2, 0.5, 1, 0.75, -0.11839639385347844, 0.25], [3, 0.75, 1, 0.875, -0.036817690757380395, 0.125], [4, 0.875, 1, 0.9375, 0.0006339161592386899, 0.0625], [5, 0.875, 0.9375, 0.90625, -0.017772289226861138, 0.03125], [6, 0.90625, 0.9375, 0.921875, -0.008486582211768012, 0.015625], [7, 0.921875, 0.9375, 0.9296875, -0.0039053586270640928, 0.0078125], [8, 0.9296875, 0.9375, 0.93359375, -0.0016304381170096915, 0.00390625], [9, 0.93359375, 0.9375, 0.935546875, -0.0004969353153195244, 0.001953125], [10, 0.935546875, 0.9375, 0.9365234375, 6.882244496264622e-05, 0.0009765625], [11, 0.935546875, 0.9365234375, 0.93603515625, -0.00021397350516394464, 0.00048828125], [12, 0.93603515625, 0.9365234375, 0.936279296875, -7.255478812057126e-05, 0.000244140625], [13, 0.936279296875, 0.9365234375, 0.9364013671875, -1.8609849000705836e-06, 0.0001220703125], [14, 0.9364013671875, 0.9365234375, 0.93646240234375, 3.348202684883006e-05, 6.103515625e-05], [15, 0.9364013671875, 0.93646240234375, 0.936431884765625, 1.5810845160335596e-05, 3.0517578125e-05], [16, 0.9364013671875, 0.936431884765625, 0.9364166259765625, 6.975011174192858e-06, 1.52587890625e-05], [17, 0.9364013671875, 0.9364166259765625, 0.9364089965820312, 2.5570333977986692e-06, 7.62939453125e-06], [18, 0.9364013671875, 0.9364089965820312, 0.9364051818847656, 3.4802931392352576e-07, 3.814697265625e-06], [19, 0.9364013671875, 0.9364051818847656, 0.9364032745361328, -7.56476526753147e-07, 1.9073486328125e-06], [20, 0.9364032745361328, 0.9364051818847656, 0.9364042282104492, -2.042232898902263e-07, 9.5367431640625e-07], [21, 0.9364042282104492, 0.9364051818847656, 0.9364047050476074, 7.190309125881811e-08, 4.76837158203125e-07], [22, 0.9364042282104492, 0.9364047050476074, 0.9364044666290283, -6.616007947046754e-08, 2.384185791015625e-07], [23, 0.9364044666290283, 0.9364047050476074, 0.9364045858383179, 2.8715108069121698e-09, 1.1920928955078125e-07], [24, 0.9364044666290283, 0.9364045858383179, 0.9364045262336731, -3.164428308277678e-08, 5.960464477539063e-08]], ['0.9364045262336731 es una aproximacion a una raiz con una tolerancia = 1e-07', True]]
:
: ['0.9364045262336731 es una aproximacion a una raiz con una tolerancia = 1e-07', True]
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-orgd006637" class="outline-4">
<h4 id="orgd006637"><span class="section-number-4">1.1.2</span> Búsquedas incrementales</h4>
<div class="outline-text-4" id="text-1-1-2">
<ul class="org-ul">
<li><p>
Como ejecutar: 
</p>
<pre class="example">
busquedasIncrementales(-3, 0.5, 100, "log(sin(x)**2 + 1) - 1/2")
</pre></li>

<li><p>
Algoritmo y resultados.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Algoritmo de busquedas incrementales</span>
<span style="color: #c397d8;">import</span> math
<span style="color: #c397d8;">from</span> py_expression_eval <span style="color: #c397d8;">import</span> Parser
<span style="color: #e78c45;">parser</span> = Parser()
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Datos de entrada:</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">f (funcion)</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">x (x inicial, x0)</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">deltax (variacion en x)</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">N (Numero maximo de iteraciones)</span>
<span style="color: #e78c45;">raices</span> = []

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">busquedasIncrementales</span>(f, x, delta, maximoIteraciones):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = [] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fx = f(x)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fx</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: x})

<span style="background-color: #2a2a2a;"> </span>   tabla.append([x, fx]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fx == 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(x) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xNuevo</span> = x + delta
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxNuevo = f(xNuevo)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxNuevo</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xNuevo})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([xNuevo, fxNuevo]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> = 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">while</span> fx * fxNuevo &gt; 0 <span style="color: #c397d8;">and</span> contadorIteraciones &lt; maximoIteraciones:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = xNuevo
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fx</span> = fxNuevo

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xNuevo</span> = x + delta
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxNuevo = f(xNuevo)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxNuevo</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xNuevo})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([xNuevo, fxNuevo]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fxNuevo == 0: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xNuevo) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> fx * fxNuevo &lt; 0: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Hay una raiz entre "</span> + <span style="color: #70c0b1;">str</span>(x) + <span style="color: #b9ca4a;">" y "</span> + <span style="color: #70c0b1;">str</span>(xNuevo), <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   raices.append([mensaje[0]])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   busquedasIncrementales(f, xNuevo, delta, (maximoIteraciones-contadorIteraciones))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Fracaso en "</span> + <span style="color: #70c0b1;">str</span>(maximoIteraciones), <span style="color: #70c0b1;">False</span>] <span style="color: #969896; font-style: italic;">#</span>


<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print(tabla)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print(mensaje)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">return [tabla, mensaje] #</span>


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">main</span>():
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x0</span> = -3
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">deltax</span> = 0.5
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">N</span> = 100
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">f</span> = <span style="color: #b9ca4a;">'log(sin(x)**2+1) - 1/2'</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print(busquedasIncrementales(f, x0, deltax, N))</span>
<span style="background-color: #2a2a2a;"> </span>   busquedasIncrementales(f, x0, deltax, N)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> fila <span style="color: #c397d8;">in</span> raices:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(fila)
<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   main()

</pre>
</div>
<pre class="example">
         #+RESULTS:
['Hay una raiz entre -2.5 y -2.0']
['Hay una raiz entre -1.0 y -0.5']
['Hay una raiz entre 0.5 y 1.0']
['Hay una raiz entre 2.0 y 2.5']
['Hay una raiz entre 4.0 y 4.5']
['Hay una raiz entre 5.0 y 5.5']
['Hay una raiz entre 7.0 y 7.5']
['Hay una raiz entre 8.0 y 8.5']
['Hay una raiz entre 10.0 y 10.5']
['Hay una raiz entre 11.5 y 12.0']
['Hay una raiz entre 13.5 y 14.0']
['Hay una raiz entre 14.5 y 15.0']
['Hay una raiz entre 16.5 y 17.0']
['Hay una raiz entre 17.5 y 18.0']
['Hay una raiz entre 19.5 y 20.0']
['Hay una raiz entre 21.0 y 21.5']
['Hay una raiz entre 22.5 y 23.0']
['Hay una raiz entre 24.0 y 24.5']
['Hay una raiz entre 26.0 y 26.5']
['Hay una raiz entre 27.0 y 27.5']
['Hay una raiz entre 29.0 y 29.5']
['Hay una raiz entre 30.0 y 30.5']
['Hay una raiz entre 32.0 y 32.5']
['Hay una raiz entre 33.5 y 34.0']
['Hay una raiz entre 35.0 y 35.5']
['Hay una raiz entre 36.5 y 37.0']
['Hay una raiz entre 38.5 y 39.0']
['Hay una raiz entre 39.5 y 40.0']
['Hay una raiz entre 41.5 y 42.0']
['Hay una raiz entre 43.0 y 43.5']
['Hay una raiz entre 44.5 y 45.0']
['Hay una raiz entre 46.0 y 46.5']
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-orgfd62e19" class="outline-4">
<h4 id="orgfd62e19"><span class="section-number-4">1.1.3</span> Regla falsa</h4>
<div class="outline-text-4" id="text-1-1-3">
<ul class="org-ul">
<li><p>
Como ejecutar:
</p>
<pre class="example">
reglaFalsa(0,1,0.0000001,100,"log(sin(x)**2 + 1) - 1/2")
</pre></li>

<li><p>
Algoritmo y resultados.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> math
<span style="color: #c397d8;">from</span> py_expression_eval <span style="color: #c397d8;">import</span> Parser

<span style="color: #e78c45;">parser</span> = Parser()

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">reglaFalsa</span>(xInferior, xSuperior, tolerancia, maximoIteraciones, f):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = [] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxInferior = f(xInferior)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxInferior</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xInferior})
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxSuperior = f(xSuperior)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxSuperior</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xSuperior})

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fxInferior == 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xInferior) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> fxSuperior == 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xSuperior) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> fxInferior * fxSuperior &lt; 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> = 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xMedio</span> = xInferior - ((fxInferior * (xSuperior - xInferior)) / (fxSuperior - fxInferior))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxMedio = f(xMedio)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxMedio</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xMedio})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, xInferior, xSuperior, xMedio, fxMedio, 0]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = tolerancia + 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">while</span> error &gt; tolerancia <span style="color: #c397d8;">and</span> fxMedio != 0 <span style="color: #c397d8;">and</span> contadorIteraciones &lt; maximoIteraciones:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fxInferior * fxMedio &lt; 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xSuperior</span> = xMedio
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxSuperior</span> = fxMedio

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xInferior</span> = xMedio
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxInferior</span> = fxMedio

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">auxiliar</span> = xMedio

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xMedio</span> = xInferior - ((fxInferior * (xSuperior - xInferior)) / (fxSuperior - fxInferior))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxMedio = f(xMedio)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxMedio</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xMedio})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = <span style="color: #70c0b1;">abs</span>(xMedio - auxiliar)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, xInferior, xSuperior, xMedio, fxMedio, error]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fxMedio == 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xMedio) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> error &lt; tolerancia:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xMedio) + <span style="color: #b9ca4a;">" es una aproximacion a una raiz con una tolerancia = "</span> + <span style="color: #70c0b1;">str</span>(tolerancia), <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Fracaso en "</span> + <span style="color: #70c0b1;">str</span>(maximoIteraciones), <span style="color: #70c0b1;">False</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"El intervalo es inadecuado."</span>, <span style="color: #70c0b1;">False</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [tabla, mensaje] <span style="color: #969896; font-style: italic;">#</span>


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">main</span>():
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = reglaFalsa(0,1,0.0000001,100,<span style="color: #b9ca4a;">"log(sin(x)**2 + 1) - 1/2"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'\n'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(a)

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   main()
</pre>
</div>
<pre class="example">
       #+RESULTS:
: 
: [[[1, 0, 1, 0.9339403807182157, -0.0014290767036854723, 0], [2, 0.9339403807182157, 1, 0.9365060516656253, 5.8756008358140654e-05, 0.0025656709474095596], [3, 0.9339403807182157, 0.9365060516656253, 0.9364047307426412, 8.678254082017389e-08, 0.0001013209229840939], [4, 0.9339403807182157, 0.9364047307426412, 0.9364045811008692, 1.281542649778089e-10, 1.4964177197374084e-07], [5, 0.9339403807182157, 0.9364045811008692, 0.936404580879889, 1.8907098109366416e-13, 2.2098023411132317e-10]], ['0.936404580879889 es una aproximacion a una raiz con una tolerancia = 1e-07', True]]
: ['0.936404580879889 es una aproximacion a una raiz con una tolerancia = 1e-07', True]
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-org51f00ca" class="outline-4">
<h4 id="org51f00ca"><span class="section-number-4">1.1.4</span> Punto fijo</h4>
<div class="outline-text-4" id="text-1-1-4">
<ul class="org-ul">
<li>Como ejecutar:</li>
</ul>
<pre class="example">
puntoFijo(-0.5,0.0000001,100,"log(sin(x)**2 + 1) - 1/2","log(sin(x)**2 + 1) - 1/2")
</pre>

<ul class="org-ul">
<li><p>
Algoritmo y resultados.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> math 
<span style="color: #c397d8;">from</span> py_expression_eval <span style="color: #c397d8;">import</span> Parser

<span style="color: #e78c45;">parser</span> = Parser()


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">puntoFijo</span>(x, tolerancia, maximoIteraciones, f, g):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = [] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fx = f(x)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fx</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: x})

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = tolerancia + 1

<span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, x,fx, 0]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">while</span> error &gt; tolerancia <span style="color: #c397d8;">and</span> contadorIteraciones &lt; maximoIteraciones <span style="color: #c397d8;">and</span> fx != 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">xNuevo = g(x)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xNuevo</span> = parser.parse(g).evaluate({<span style="color: #b9ca4a;">"x"</span>: x})
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fx = f(xNuevo)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fx</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xNuevo})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = <span style="color: #70c0b1;">abs</span>(xNuevo - x)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = xNuevo

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, x, fx, error]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fx == 0: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(x) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> error &lt;= tolerancia: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(x) + <span style="color: #b9ca4a;">" es una aproximacion con tolerancia "</span> + <span style="color: #70c0b1;">str</span>(tolerancia), <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Fracaso en "</span> + <span style="color: #70c0b1;">str</span>(maximoIteraciones) + <span style="color: #b9ca4a;">" iteraciones."</span>, <span style="color: #70c0b1;">False</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [tabla, mensaje]


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">main</span>():
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = puntoFijo(-0.5,0.0000001,100,<span style="color: #b9ca4a;">"log(sin(x)**2 + 1) - 1/2"</span>,<span style="color: #b9ca4a;">"log(sin(x)**2 + 1) - 1/2"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'\n'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(a)

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   main()
</pre>
</div>
<pre class="example">
       #+RESULTS:
: 
: [[[0, -0.5, -0.2931087267313766, 0], [1, -0.2931087267313766, -0.41982154360625734, 0.2068912732686234], [2, -0.41982154360625734, -0.3463045191776651, 0.12671281687488073], [3, -0.3463045191776651, -0.3909584565423095, 0.07351702442859226], [4, -0.3909584565423095, -0.3644050348941392, 0.0446539373646444], [5, -0.3644050348941392, -0.3804263031679563, 0.02655342164817026], [6, -0.3804263031679563, -0.37083679528020885, 0.016021268273817058], [7, -0.37083679528020885, -0.3766056453635812, 0.009589507887747428], [8, -0.3766056453635812, -0.373145417607189, 0.005768850083372357], [9, -0.373145417607189, -0.3752246411870562, 0.003460227756392209], [10, -0.3752246411870562, -0.37397658604830963, 0.002079223579867173], [11, -0.37397658604830963, -0.3747262157084321, 0.00124805513874654], [12, -0.3747262157084321, -0.37427613331045395, 0.0007496296601224861], [13, -0.37427613331045395, -0.3745464284580923, 0.00045008239797816874], [14, -0.3745464284580923, -0.3743841264348447, 0.00027029514763832196], [15, -0.3743841264348447, -0.3744815908319551, 0.0001623020232475736], [16, -0.3744815908319551, -0.37442306518389706, 9.746439711039168e-05], [17, -0.37442306518389706, -0.37445820986270584, 5.8525648058027624e-05], [18, -0.37445820986270584, -0.3744371058494556, 3.514467880877392e-05], [19, -0.3744371058494556, -0.37444977872741303, 2.110401325022826e-05], [20, -0.37444977872741303, -0.37444216876320036, 1.2672877957420337e-05], [21, -0.37444216876320036, -0.3744467385052047, 7.609964212673681e-06], [22, -0.3744467385052047, -0.37444399440652526, 4.5697420043566694e-06], [23, -0.37444399440652526, -0.37444564222126353, 2.744098679452467e-06], [24, -0.37444564222126353, -0.37444465271927385, 1.647814738270359e-06], [25, -0.37444465271927385, -0.3744452469090602, 9.895019896788426e-07], [26, -0.3744452469090602, -0.37444489010190096, 5.941897863737111e-07], [27, -0.37444489010190096, -0.37444510436235334, 3.568071592630062e-07], [28, -0.37444510436235334, -0.3744449757003151, 2.1426045238026603e-07], [29, -0.3744449757003151, -0.37444505296105535, 1.28662038245686e-07], [30, -0.37444505296105535, -0.3744450065664714, 7.726074024994034e-08]], ['-0.37444505296105535 es una aproximacion con tolerancia 1e-07', True]]
:
: ['-0.37444505296105535 es una aproximacion con tolerancia 1e-07', True]
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-orgdefa9af" class="outline-4">
<h4 id="orgdefa9af"><span class="section-number-4">1.1.5</span> Newton</h4>
<div class="outline-text-4" id="text-1-1-5">
<ul class="org-ul">
<li>Como ejecutar:</li>
</ul>
<pre class="example">
newton(0.5,0.0000001,100,"log(sin(x)**2 + 1) - 1/2","(2*sin(x)*cos(x))/(sin(x)**2 + 1)")
</pre>

<ul class="org-ul">
<li><p>
Algoritmo y resultados.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> math 
<span style="color: #c397d8;">from</span> py_expression_eval <span style="color: #c397d8;">import</span> Parser

<span style="color: #e78c45;">parser</span> = Parser()

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">newton</span>(x, tolerancia, maximoIteraciones, f, df):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = [] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fx = f(x)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fx</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: x})
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">derivada = fd(x)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">derivada</span> = parser.parse(df).evaluate({<span style="color: #b9ca4a;">"x"</span>: x})

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = tolerancia + 1

<span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, x, fx, derivada, 0]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">while</span> error &gt; tolerancia <span style="color: #c397d8;">and</span> contadorIteraciones &lt; maximoIteraciones <span style="color: #c397d8;">and</span> fx != 0 <span style="color: #c397d8;">and</span> derivada != 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xNuevo</span> = x - (fx / derivada)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fx = f(xNuevo)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fx</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xNuevo})
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">derivada = fd(xNuevo)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">derivada</span> = parser.parse(df).evaluate({<span style="color: #b9ca4a;">"x"</span>: xNuevo})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = <span style="color: #70c0b1;">abs</span>(xNuevo - x)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = xNuevo

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, x, fx, derivada, error]) <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fx == 0: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(x) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> error &lt;= tolerancia: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(x) + <span style="color: #b9ca4a;">" es una aproximacion con tolerancia "</span> + <span style="color: #70c0b1;">str</span>(tolerancia), <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> derivada == 0: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xNuevo) + <span style="color: #b9ca4a;">"es una posible raiz multiple"</span>, <span style="color: #70c0b1;">True</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Fracaso en "</span> + <span style="color: #70c0b1;">str</span>(maximoIteraciones) + <span style="color: #b9ca4a;">" iteraciones."</span>, <span style="color: #70c0b1;">False</span>] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [tabla, mensaje]

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">main</span>():
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = newton(0.5,0.0000001,100,<span style="color: #b9ca4a;">"log(sin(x)**2 + 1) - 1/2"</span>,<span style="color: #b9ca4a;">"(2*sin(x)*cos(x))/(sin(x)**2 + 1)"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'\n'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(a)

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   main()
</pre>
</div>
<pre class="example">
#+RESULTS:
:
: [[[0, 0.5, -0.2931087267313766, 0.6842068330717285, 0], [1, 0.9283919899125719, -0.004662157097372055, 0.5846147284064962, 0.4283919899125719], [2, 0.9363667412673313, -2.1912619882713535e-05, 0.5791052537949999, 0.007974751354759446], [3, 0.9364045800189902, -4.98339092214195e-10, 0.5790789133390185, 3.783875165885853e-05], [4, 0.9364045808795621, -1.1102230246251565e-16, 0.5790789127399327, 8.605719470367035e-10]], ['0.9364045808795621 es una aproximacion con tolerancia 1e-07', True]]
: 
: ['0.9364045808795621 es una aproximacion con tolerancia 1e-07', True]       
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-orgd0d5cad" class="outline-4">
<h4 id="orgd0d5cad"><span class="section-number-4">1.1.6</span> Secante</h4>
<div class="outline-text-4" id="text-1-1-6">
<ul class="org-ul">
<li><p>
Como ejecutar: 
</p>
<pre class="example">
secante(0.5,1,0.0000001,100,"log(sin(x)**2 + 1) - 1/2")
</pre></li>

<li><p>
Algoritmo y resultados
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> math 
<span style="color: #c397d8;">from</span> py_expression_eval <span style="color: #c397d8;">import</span> Parser

<span style="color: #e78c45;">parser</span> = Parser()

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">secante</span>(x, xNuevo, tolerancia, maximoIteraciones, f):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = [] <span style="color: #969896; font-style: italic;">#</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fx = f(x)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fx</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: x})

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fx == 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(x) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>]     

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxNuevo = f(xNuevo)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxNuevo</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xNuevo})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = tolerancia + 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">denominador</span> = fxNuevo - fx

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, x, fx, 0])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones + 1, xNuevo, fxNuevo, 0])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">while</span> error &gt; tolerancia <span style="color: #c397d8;">and</span> fxNuevo != 0 <span style="color: #c397d8;">and</span> denominador != 0 <span style="color: #c397d8;">and</span> contadorIteraciones &lt; maximoIteraciones:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xAuxiliar</span> = xNuevo - fxNuevo * (xNuevo - x) / denominador

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = <span style="color: #70c0b1;">abs</span>(xAuxiliar - xNuevo)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = xNuevo
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fx</span> = fxNuevo

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xNuevo</span> = xAuxiliar
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fxNuevo = f(xNuevo)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fxNuevo</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xNuevo})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">denominador</span> = fxNuevo - fx

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones + 1, xNuevo, fxNuevo, error])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fxNuevo == 0: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xNuevo) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>]     

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> error &lt; tolerancia: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(xNuevo) + <span style="color: #b9ca4a;">" es una aproximacion a una raiz con tolerancia="</span> + <span style="color: #70c0b1;">str</span>(tolerancia), <span style="color: #70c0b1;">True</span>]     

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> denominador == 0: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Hay una posible raiz multiple"</span>, <span style="color: #70c0b1;">True</span>]     

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Fracaso en "</span> + <span style="color: #70c0b1;">str</span>(maximoIteraciones) + <span style="color: #b9ca4a;">" iteraciones."</span>, <span style="color: #70c0b1;">False</span>]

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [tabla, mensaje]

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">main</span>():
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = secante(0.5,1,0.0000001,100,<span style="color: #b9ca4a;">"log(sin(x)**2 + 1) - 1/2"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'\n'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(a)

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   main()
</pre>
</div>
<pre class="example">
       #+RESULTS:
: 
: [[[0, 0.5, -0.2931087267313766, 0], [1, 1, 0.03536607938024017, 0], [2, 0.946166222306525, 0.005619392737863826, 0.05383377769347497], [3, 0.9359965807911726, -0.00023632217470054284, 0.010169641515352379], [4, 0.9364070023767038, 1.4022358909571153e-06, 0.00041042158553117325], [5, 0.9364045814731196, 3.4371649970665885e-10, 2.420903584265943e-06], [6, 0.9364045808795615, -4.996003610813204e-16, 5.935580915661376e-10]], ['0.9364045808795615 es una aproximacion a una raiz con tolerancia=1e-07', True]]
:
: ['0.9364045808795615 es una aproximacion a una raiz con tolerancia=1e-07', True]
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-org09995cd" class="outline-4">
<h4 id="org09995cd"><span class="section-number-4">1.1.7</span> Raíces múltiples</h4>
<div class="outline-text-4" id="text-1-1-7">
<ul class="org-ul">
<li>Como ejecutar:</li>
</ul>
<pre class="example">
raicesMultiples(1,0.0000001,100,"exp(x) - x - 1","exp(x) - x","exp(x)")
</pre>

<ul class="org-ul">
<li>Algoritmo y resultado</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> math
<span style="color: #c397d8;">from</span> py_expression_eval <span style="color: #c397d8;">import</span> Parser

<span style="color: #e78c45;">parser</span> = Parser()

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">raicesMultiples</span>(x, tolerancia, maximoIteraciones, f, df, ddf):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fx = f(x)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fx</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: x})
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fdx = fd(x)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fdx</span> = parser.parse(df).evaluate({<span style="color: #b9ca4a;">"x"</span>: x})
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fddx = fdd(x)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fddx</span> = parser.parse(ddf).evaluate({<span style="color: #b9ca4a;">"x"</span>: x})

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = tolerancia + 1

<span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, x, fx, fdx, fddx, 0])

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">while</span> error &gt; tolerancia <span style="color: #c397d8;">and</span> contadorIteraciones &lt; maximoIteraciones <span style="color: #c397d8;">and</span> fx != 0 <span style="color: #c397d8;">and</span> fdx != 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">xNuevo</span> = x - ((fx * fdx) / (math.<span style="color: #70c0b1;">pow</span>(fdx, 2) - fx * fddx)) <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Habia un error, estaba math.pow(fddx, 2) </span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fx = f(xNuevo)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fx</span> = parser.parse(f).evaluate({<span style="color: #b9ca4a;">"x"</span>: xNuevo})
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fdx = fd(xNuevo)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fdx</span> = parser.parse(df).evaluate({<span style="color: #b9ca4a;">"x"</span>: xNuevo})
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">fddx = fdd(xNuevo)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fddx</span> = parser.parse(ddf).evaluate({<span style="color: #b9ca4a;">"x"</span>: xNuevo})

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">error</span> = <span style="color: #70c0b1;">abs</span>(xNuevo - x)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = xNuevo

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contadorIteraciones</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   tabla.append([contadorIteraciones, x, fx, fdx, fddx, error])

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> fx == 0: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(x) + <span style="color: #b9ca4a;">" es una raiz."</span>, <span style="color: #70c0b1;">True</span>]     

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> error &lt;= tolerancia: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(x) + <span style="color: #b9ca4a;">" es una aproximacion a una raiz con tolerancia="</span> + <span style="color: #70c0b1;">str</span>(tolerancia), <span style="color: #70c0b1;">True</span>]     

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> fdx == 0: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Hay una posible raiz multiple"</span>, <span style="color: #70c0b1;">True</span>]     

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Fracaso en "</span> + <span style="color: #70c0b1;">str</span>(maximoIteraciones) + <span style="color: #b9ca4a;">" iteraciones."</span>, <span style="color: #70c0b1;">False</span>]

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [tabla, mensaje]

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">main</span>():
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">hx</span> = <span style="color: #b9ca4a;">"exp(x)-x-1"</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dhx</span> = <span style="color: #b9ca4a;">"exp(x)-1"</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ddhx</span> = <span style="color: #b9ca4a;">"exp(x)"</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">TOL</span> = 0.0000001
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">N</span> = 100
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x0</span> = 1
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">resultado</span> = raicesMultiples(1, TOL, N, hx, dhx, ddhx)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(resultado)

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   main()
</pre>
</div>
<pre class="example">
 #+RESULTS:
: [[[0, 1, 0.7182818284590451, 1.718281828459045, 2.718281828459045, 0], [1, -0.23421061355351425, 0.025405775475345838, -0.20880483807816852, 0.7911951619218315, 1.2342106135535142], [2, -0.00845827991076109, 3.567060801401567e-05, -0.008422609302746964, 0.991577390697253, 0.22575233364275316], [3, -1.1890183808588653e-05, 7.068789997788372e-11, -1.1890113120638368e-05, 0.9999881098868794, 0.008446389726952502], [4, -4.218590698935789e-11, 0.0, -4.218592142279931e-11, 0.9999999999578141, 1.1890141622681664e-05]], ['-4.218590698935789e-11 es una raiz.', True]]
:
: ['-4.218590698935789e-11 es una raiz.', True]
</pre>
</div>
</div>
</div>


<div id="outline-container-org488808e" class="outline-3">
<h3 id="org488808e"><span class="section-number-3">1.2</span> Solución de sistemas de ecuaciones lineales</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>Definir A, b y la matriz aumentada Ab</li>
<li><p>
True imprime las etapas.
</p>
<pre class="example">
 A =[
   [2, -1, 0, 3],
   [1, 0.5, 3, 8],
   [0, 13, -2, 11],
   [14, 5, -1, 3]
   ]

b = [1, 1, 1, 1]

Ab = matrizAumentada(A, b)
</pre></li>
</ul>
</div>

<div id="outline-container-org2062df8" class="outline-4">
<h4 id="org2062df8"><span class="section-number-4">1.2.1</span> Eliminación gaussiana</h4>
<div class="outline-text-4" id="text-1-2-1">
<ul class="org-ul">
<li><p>
Como ejecutar:
</p>
<pre class="example">
gaussianaSimple(Ab, len(Ab), True)
</pre></li>

<li><p>
Algoritmo y resultado
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">valorMatriz</span>(Matriz):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">nuevaMatriz</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(Matriz)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fila</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(Matriz[0])):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   fila.append(Matriz[i][j])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   nuevaMatriz.append(fila)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> nuevaMatriz

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">matrizAumentada</span>(A, b):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">matrizAumentada</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">copiaDeA</span> = valorMatriz(A)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(copiaDeA)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   copiaDeA[i].append(b[i])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizAumentada.append(copiaDeA[i])

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> matrizAumentada

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">imprimirMatriz</span>(Matriz): 
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> fila <span style="color: #c397d8;">in</span> Matriz: <span style="color: #c397d8;">print</span>(fila)


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">sustitucionRegresiva</span>(Ab):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> pivotIndex <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>((<span style="color: #70c0b1;">len</span>(Ab) - 1), -1, -1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">summation</span> = <span style="color: #e78c45;">i</span> =  0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> column <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>((<span style="color: #70c0b1;">len</span>(Ab[0]) - 2), pivotIndex, -1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">summation</span> +=  Ab[pivotIndex][column] * x[i]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">i</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   x.append( ( Ab[pivotIndex][<span style="color: #70c0b1;">len</span>(Ab[0]) - 1] - summation ) / Ab[pivotIndex][pivotIndex] )

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> x[::-1]


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">gaussianaSimple</span>(AbParam, n, printEtapas):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">AbParam es la matriz aumentada Ab</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">n = len(AbParam)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">etapas</span> = [] 

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Ab</span> = valorMatriz(AbParam)

<span style="background-color: #2a2a2a;"> </span>   etapas.append(valorMatriz(Ab))

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">Eliminaci&#243;n</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n - 1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">multiplicadoresDeEtapa</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k + 1, n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">multiplicator</span> = Ab[i][k] / Ab[k][k]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k, n + 1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   Ab[i][j] = Ab[i][j] - ( multiplicator * Ab[k][j] )

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   etapas.append(valorMatriz(Ab))

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> printEtapas == <span style="color: #70c0b1;">True</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span> (<span style="color: #70c0b1;">len</span>(etapas)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Etapa"</span>,i,<span style="color: #b9ca4a;">":"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(etapas[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">" "</span>)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print("Etapa ", len(etapas), ": ")</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">imprimirMatriz(etapas[-1]) #etapas[-1] es lo mismo que decir etapas en la ultima posicion   </span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Sustitucion regresiva:</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = sustitucionRegresiva(Ab)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">imprimirMatriz(x)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span>[x]

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">main</span>():
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">A</span> = [
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [2, -1, 0, 3],
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [1, 0.5, 3, 8],
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [0, 13, -2, 11],
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [14, 5, -2, 3]
<span style="background-color: #2a2a2a;"> </span>   ]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = [1, 1, 1, 1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Ab</span> = matrizAumentada(A, b)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Matriz A: "</span>)
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(A)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Vector b: "</span>)
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(b)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Matriz Ab: "</span>)
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(Ab)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">imprimirEtapas</span> = <span style="color: #70c0b1;">True</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Despues de aplicar sustitucion Gaussiana simple: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">resultado</span> = gaussianaSimple(Ab, <span style="color: #70c0b1;">len</span>(Ab), imprimirEtapas)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"resultados x: "</span>)
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(resultado)




<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   main()
</pre>
</div>
<pre class="example">
      #+RESULTS:
#+begin_example
Matriz A: 
[2, -1, 0, 3]
[1, 0.5, 3, 8]
[0, 13, -2, 11]
[14, 5, -2, 3]
Vector b: 
1
1
1
1
Matriz Ab: 
[2, -1, 0, 3, 1]
[1, 0.5, 3, 8, 1]
[0, 13, -2, 11, 1]
[14, 5, -2, 3, 1]
Despues de aplicar sustitucion Gaussiana simple: 
Etapa 0 :
[2, -1, 0, 3, 1]
[1, 0.5, 3, 8, 1]
[0, 13, -2, 11, 1]
[14, 5, -2, 3, 1]

Etapa 1 :
[2, -1, 0, 3, 1]
[0.0, 1.0, 3.0, 6.5, 0.5]
[0.0, 13.0, -2.0, 11.0, 1.0]
[0.0, 12.0, -2.0, -18.0, -6.0]

Etapa 2 :
[2, -1, 0, 3, 1]
[0.0, 1.0, 3.0, 6.5, 0.5]
[0.0, 0.0, -41.0, -73.5, -5.5]
[0.0, 0.0, -38.0, -96.0, -12.0]

Etapa 3 :
[2, -1, 0, 3, 1]
[0.0, 1.0, 3.0, 6.5, 0.5]
[0.0, 0.0, -41.0, -73.5, -5.5]
[0.0, 0.0, 0.0, -27.878048780487802, -6.902439024390244]

resultados x: 
[0.03849518810148722, -0.18022747156605434, -0.30971128608923887, 0.24759405074365706]
#+end_example
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-org7cee8c2" class="outline-4">
<h4 id="org7cee8c2"><span class="section-number-4">1.2.2</span> Pivoteo parcial</h4>
<div class="outline-text-4" id="text-1-2-2">
<ul class="org-ul">
<li><p>
Como ejecutar:
</p>
<pre class="example">
gaussianaPivoteoParcial(Ab, len(Ab), True)
</pre></li>

<li><p>
Algoritmo y resultado
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> math
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">valorMatriz</span>(Matriz):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">nuevaMatriz</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(Matriz)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fila</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(Matriz[0])):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   fila.append(Matriz[i][j])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   nuevaMatriz.append(fila)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> nuevaMatriz

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">matrizAumentada</span>(A, b):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">matrizAumentada</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">copiaDeA</span> = valorMatriz(A)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(copiaDeA)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   copiaDeA[i].append(b[i])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizAumentada.append(copiaDeA[i])

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> matrizAumentada

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">imprimirMatriz</span>(Matriz): 
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> fila <span style="color: #c397d8;">in</span> Matriz: <span style="color: #c397d8;">print</span>(fila)

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">intercambiarFilas</span>(M, indexA, indexB):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">aux</span> = M[indexA]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">M</span>[indexA] = M[indexB]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">M</span>[indexB] = aux

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">pivoteoParcial</span>(Ab, k, n):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mayor</span> = math.fabs(Ab[k][k])
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">filaMayor</span> = k

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k + 1, n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> math.fabs(Ab[i][k]) &gt; mayor:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mayor</span> = Ab[i][k]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">filaMayor</span> = i

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> mayor == 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"El sistema no tiene soluci&#243;n &#250;nica."</span>)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> filaMayor != k:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   intercambiarFilas(Ab, k, filaMayor)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> filaMayor

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">sustitucionRegresiva</span>(Ab):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> pivotIndex <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>((<span style="color: #70c0b1;">len</span>(Ab) - 1), -1, -1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">summation</span> = <span style="color: #e78c45;">i</span> =  0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> column <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>((<span style="color: #70c0b1;">len</span>(Ab[0]) - 2), pivotIndex, -1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">summation</span> +=  Ab[pivotIndex][column] * x[i]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">i</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   x.append( ( Ab[pivotIndex][<span style="color: #70c0b1;">len</span>(Ab[0]) - 1] - summation ) / Ab[pivotIndex][pivotIndex] )

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> x[::-1]

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">gaussianaPivoteoParcial</span>(AbParam, n, imprimirEtapas):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">etapas</span> = [] 
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">etapasPrevias</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">filaMayorList</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Ab</span> = valorMatriz(AbParam)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">Eliminaci&#243;n</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n - 1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   etapasPrevias.append(valorMatriz(Ab))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">filaMayor</span> = pivoteoParcial(Ab, k, n)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   filaMayorList.append(filaMayor)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   etapas.append(valorMatriz(Ab))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">multiplicadoresDeEtapa</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k + 1, n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">multiplicator</span> = Ab[i][k] / Ab[k][k]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k, n + 1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   Ab[i][j] = Ab[i][j] - ( multiplicator * Ab[k][j] )


<span style="background-color: #2a2a2a;"> </span>   etapasPrevias.append(valorMatriz(Ab))
<span style="background-color: #2a2a2a;"> </span>   etapas.append(valorMatriz(Ab))
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> imprimirEtapas == <span style="color: #70c0b1;">True</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span> (<span style="color: #70c0b1;">len</span>(etapas)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Etapa"</span>,i,<span style="color: #b9ca4a;">":"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(etapas[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">" "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Sustitucion regresiva</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = sustitucionRegresiva(Ab)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [etapas, x, filaMayorList, etapasPrevias]

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">main</span>():
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">A</span> = [
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [2, -1, 0, 3],
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [1, 0.5, 3, 8],
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [0, 13, -2, 11],
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [14, 5, -2, 3]
<span style="background-color: #2a2a2a;"> </span>   ]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = [1, 1, 1, 1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Ab</span> = matrizAumentada(A, b)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Matriz A: "</span>)
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(A)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Vector b: "</span>)
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(b)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Matriz Ab: "</span>)
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(Ab)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">imprimirEtapas</span> = <span style="color: #70c0b1;">True</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Despues de aplicar sustitucion Gaussiana con pivoteo parcial: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">resultado</span> = gaussianaPivoteoParcial(Ab, <span style="color: #70c0b1;">len</span>(Ab), imprimirEtapas)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = resultado[1]
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(x)


<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   main()
</pre>
</div>
<pre class="example">
      #+RESULTS:
#+begin_example
Matriz A: 
[2, -1, 0, 3]
[1, 0.5, 3, 8]
[0, 13, -2, 11]
[14, 5, -2, 3]
Vector b: 
1
1
1
1
Matriz Ab: 
[2, -1, 0, 3, 1]
[1, 0.5, 3, 8, 1]
[0, 13, -2, 11, 1]
[14, 5, -2, 3, 1]
Despues de aplicar sustitucion Gaussiana con pivoteo parcial: 
Etapa 0 :
[14, 5, -2, 3, 1]
[1, 0.5, 3, 8, 1]
[0, 13, -2, 11, 1]
[2, -1, 0, 3, 1]

Etapa 1 :
[14, 5, -2, 3, 1]
[0.0, 13.0, -2.0, 11.0, 1.0]
[0.0, 0.1428571428571429, 3.142857142857143, 7.785714285714286, 0.9285714285714286]
[0.0, -1.7142857142857142, 0.2857142857142857, 2.5714285714285716, 0.8571428571428572]

Etapa 2 :
[14, 5, -2, 3, 1]
[0.0, 13.0, -2.0, 11.0, 1.0]
[0.0, 0.0, 3.1648351648351647, 7.664835164835164, 0.9175824175824177]
[0.0, 2.220446049250313e-16, 0.021978021978021955, 4.021978021978022, 0.989010989010989]

Etapa 3 :
[14, 5, -2, 3, 1]
[0.0, 13.0, -2.0, 11.0, 1.0]
[0.0, 0.0, 3.1648351648351647, 7.664835164835164, 0.9175824175824177]
[0.0, 2.220446049250313e-16, 0.0, 3.96875, 0.982638888888889]

0.0384951881014873
-0.18022747156605426
-0.30971128608923887
0.24759405074365706
#+end_example
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-org97b7c81" class="outline-4">
<h4 id="org97b7c81"><span class="section-number-4">1.2.3</span> Pivoteo total</h4>
<div class="outline-text-4" id="text-1-2-3">
<ul class="org-ul">
<li><p>
Como ejecutar:
</p>
<pre class="example">
gaussianaPivoteoTotal(Ab, len(Ab), True)
</pre></li>

<li><p>
Algoritmo y resultado
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> math

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">valorMatriz</span>(Matriz):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">nuevaMatriz</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(Matriz)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fila</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(Matriz[0])):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   fila.append(Matriz[i][j])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   nuevaMatriz.append(fila)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> nuevaMatriz

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">matrizAumentada</span>(A, b):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">matrizAumentada</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">copiaDeA</span> = valorMatriz(A)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(copiaDeA)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   copiaDeA[i].append(b[i])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizAumentada.append(copiaDeA[i])

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> matrizAumentada

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">imprimirMatriz</span>(Matriz): 
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> fila <span style="color: #c397d8;">in</span> Matriz: <span style="color: #c397d8;">print</span>(fila)

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">sustitucionRegresiva</span>(Ab):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> pivotIndex <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>((<span style="color: #70c0b1;">len</span>(Ab) - 1), -1, -1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">summation</span> = <span style="color: #e78c45;">i</span> =  0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> column <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>((<span style="color: #70c0b1;">len</span>(Ab[0]) - 2), pivotIndex, -1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">summation</span> +=  Ab[pivotIndex][column] * x[i]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">i</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   x.append( ( Ab[pivotIndex][<span style="color: #70c0b1;">len</span>(Ab[0]) - 1] - summation ) / Ab[pivotIndex][pivotIndex] )

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> x[::-1]

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">intercambiarFilas</span>(M, indexA, indexB):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">aux</span> = M[indexA]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">M</span>[indexA] = M[indexB]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">M</span>[indexB] = aux

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">intercambiarColumnas</span>(M, indexA, indexB, marcas):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">auxMarcas</span> = marcas[indexA]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">marcas</span>[indexA] = marcas[indexB]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">marcas</span>[indexB] = auxMarcas

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(M)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">aux</span> = M[i][indexA]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   M[i][indexA] = M[i][indexB]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   M[i][indexB] = aux


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">pivoteoTotal</span>(Ab, k, n, marcas):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mayor</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">filaMayor</span> = k
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">columnaMayor</span> = k

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k, n):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k, n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> math.fabs(Ab[i][j]) &gt; mayor:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mayor</span> = math.fabs(Ab[i][j])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">filaMayor</span> = i
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">columnaMayor</span> = j

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> mayor == 0:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"El sistema no tiene soluci&#243;n &#250;nica."</span>)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> filaMayor != k: 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   intercambiarFilas(Ab, k, filaMayor)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> columnaMayor != k:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   intercambiarColumnas(Ab, k, columnaMayor, marcas)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [filaMayor, columnaMayor]



<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">gaussianaPivoteoTotal</span>(AbParam, n, imprimirEtapas):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">etapas</span> = [] 
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">etapasPrevias</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mayorList</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">marcas</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n): marcas.append(i)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Ab</span> = valorMatriz(AbParam)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">Eliminaci&#243;n</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n - 1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   etapasPrevias.append(valorMatriz(Ab))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mayorIndex</span> = pivoteoTotal(Ab, k, n, marcas)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">filaMayor</span> = mayorIndex[0]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">columnaMayor</span> = mayorIndex[1]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   mayorList.append([filaMayor, columnaMayor])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   etapas.append(valorMatriz(Ab))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">multiplicadoresDeEtapa</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k + 1, n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">multiplicator</span> = Ab[i][k] / Ab[k][k]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k, n + 1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   Ab[i][j] = Ab[i][j] - ( multiplicator * Ab[k][j] )


<span style="background-color: #2a2a2a;"> </span>   etapasPrevias.append(valorMatriz(Ab))
<span style="background-color: #2a2a2a;"> </span>   etapas.append(valorMatriz(Ab))
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> imprimirEtapas == <span style="color: #70c0b1;">True</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span> (<span style="color: #70c0b1;">len</span>(etapas)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Etapa"</span>,i,<span style="color: #b9ca4a;">":"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(etapas[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">" "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">Sustituci&#243;n regresiva</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = sustitucionRegresiva(Ab)


<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [etapas, x, mayorList, etapasPrevias, marcas]

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">main</span>():
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">A</span> = [
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [2, -1, 0, 3],
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [1, 0.5, 3, 8],
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [0, 13, -2, 11],
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   [14, 5, -2, 3]
<span style="background-color: #2a2a2a;"> </span>   ]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = [1, 1, 1, 1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Ab</span> = matrizAumentada(A, b)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Matriz A: "</span>)
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(A)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Vector b: "</span>)
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(b)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Matriz Ab: "</span>)
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(Ab)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">imprimirEtapas</span> = <span style="color: #70c0b1;">True</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"*******************************************************************************"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Despues de aplicar sustitucion Gaussiana con pivoteo total: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">resultado</span> = gaussianaPivoteoTotal(Ab, <span style="color: #70c0b1;">len</span>(Ab), imprimirEtapas)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Resultados x: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = resultado[1]
<span style="background-color: #2a2a2a;"> </span>   imprimirMatriz(x)

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   main()
</pre>
</div>
<pre class="example">
      #+RESULTS:
#+begin_example
Matriz A: 
[2, -1, 0, 3]
[1, 0.5, 3, 8]
[0, 13, -2, 11]
[14, 5, -2, 3]
Vector b: 
1
1
1
1
Matriz Ab: 
[2, -1, 0, 3, 1]
[1, 0.5, 3, 8, 1]
[0, 13, -2, 11, 1]
[14, 5, -2, 3, 1]
*******************************************************************************
Despues de aplicar sustitucion Gaussiana con pivoteo total: 
Etapa 0 :
[14, 5, -2, 3, 1]
[1, 0.5, 3, 8, 1]
[0, 13, -2, 11, 1]
[2, -1, 0, 3, 1]

Etapa 1 :
[14, 5, -2, 3, 1]
[0.0, 13.0, -2.0, 11.0, 1.0]
[0.0, 0.1428571428571429, 3.142857142857143, 7.785714285714286, 0.9285714285714286]
[0.0, -1.7142857142857142, 0.2857142857142857, 2.5714285714285716, 0.8571428571428572]

Etapa 2 :
[14, 5, 3, -2, 1]
[0.0, 13.0, 11.0, -2.0, 1.0]
[0.0, 0.0, 7.664835164835164, 3.1648351648351647, 0.9175824175824177]
[0.0, 2.220446049250313e-16, 4.021978021978022, 0.021978021978021955, 0.989010989010989]

Etapa 3 :
[14, 5, 3, -2, 1]
[0.0, 13.0, 11.0, -2.0, 1.0]
[0.0, 0.0, 7.664835164835164, 3.1648351648351647, 0.9175824175824177]
[0.0, 2.220446049250313e-16, 0.0, -1.638709677419355, 0.5075268817204301]

Resultados x: 
0.038495188101487325
-0.18022747156605423
0.24759405074365703
-0.3097112860892388
#+end_example
</pre></li>
</ul>
</div>
</div>
</div>
</div>






<div id="outline-container-org529ee42" class="outline-2">
<h2 id="org529ee42"><span class="section-number-2">2</span> Métodos de la segunda entrega</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li><p>
Datos a usar. Nmax = 100; Tol = 1e-7 
</p>
<p>
Matriz A = 
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">4</td>
<td class="org-right">-1</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">15.5</td>
<td class="org-right">3</td>
<td class="org-right">8</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-right">-1.3</td>
<td class="org-right">-4</td>
<td class="org-right">1.1</td>
</tr>

<tr>
<td class="org-right">14</td>
<td class="org-right">5</td>
<td class="org-right">-2</td>
<td class="org-right">30</td>
</tr>
</tbody>
</table>
<p>
Vector b =
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>
X0 =
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>
Tabla = 
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">x</td>
<td class="org-right">-1</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-right">15.5</td>
<td class="org-right">3</td>
<td class="org-right">8</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
<div id="outline-container-orgb2a76b8" class="outline-3">
<h3 id="orgb2a76b8"><span class="section-number-3">2.1</span> Solución de sistemas de ecuaciones lineales</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org6b3595d" class="outline-4">
<h4 id="org6b3595d"><span class="section-number-4">2.1.1</span> LU con gaussiana simple, Lu con pivoteo parcial</h4>
<div class="outline-text-4" id="text-2-1-1">
<ul class="org-ul">
<li>Algoritmo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> numpy <span style="color: #c397d8;">as</span> np
<span style="color: #c397d8;">from</span> math <span style="color: #c397d8;">import</span> sqrt
<span style="color: #c397d8;">from</span> tabulate <span style="color: #c397d8;">import</span> tabulate

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">getOption</span>(message, options):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">while</span> <span style="color: #70c0b1;">True</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ans</span> = <span style="color: #70c0b1;">input</span>(message)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> options:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> i == ans:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> i
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">interRow</span>(array, row1, row2):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> row1 != row2:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">aux</span> = array[row1].copy()
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[row1] = array[row2]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[row2] = aux

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">interCol</span>(array, col1, col2):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> col1 != col2:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">aux</span> = array[:,col1].copy()
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,col1] = array[:,col2]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,col2] = aux


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">solNumpy</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">A</span> = array[:,0:-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">B</span> = array[:,-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">solution</span> = np.linalg.solve(A, B)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> solution
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">sumMultRow</span>(array, rowAct, rowMult, mult, init):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[rowAct,init:] = array[rowAct,init:] + mult * array[rowMult,init:]
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">checkSquare</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">rows</span> = <span style="color: #70c0b1;">len</span>(array)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span> (0,rows):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">len</span>(array[i]) != rows:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">raise</span> <span style="color: #e7c547;">Exception</span>(<span style="color: #b9ca4a;">'La matriz debe ser cuadrada'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> rows
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">checkDet</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">det</span> = np.linalg.det(array)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Determinante: '</span> + <span style="color: #70c0b1;">str</span>(det))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> det == 0: <span style="color: #c397d8;">raise</span> <span style="color: #e7c547;">Exception</span>(<span style="color: #b9ca4a;">'La determinante de la matriz debe ser diferente a cero'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tol</span> = 10e-4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">abs</span>(det) &lt; tol:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">option</span> = getOption(<span style="color: #b9ca4a;">'La determinante es menor a '</span> + <span style="color: #70c0b1;">str</span>(tol) 
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   + <span style="color: #b9ca4a;">' y puede presentar problemas de evaluaci&#243;n &#191;Desea continuar? si[s] no[n]'</span>,[<span style="color: #b9ca4a;">'s'</span>,<span style="color: #b9ca4a;">'n'</span>])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> option == <span style="color: #b9ca4a;">'n'</span>: <span style="color: #c397d8;">raise</span> <span style="color: #e7c547;">Exception</span>(<span style="color: #b9ca4a;">'Operaci&#243;n abortada por el usuario'</span>)


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">pivoteoParcial</span>(array, col, dimension):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">maxRow</span> = np.argmax(<span style="color: #70c0b1;">abs</span>(array[col:,col])) + col
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   interRow(array,col,maxRow)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span>

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">progSustitution</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Sustituci&#243;n progresiva---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimension</span> = <span style="color: #70c0b1;">len</span>(array)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">solution</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">np.dot(A,B)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> row <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(0, dimension):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">variable</span> = (array[row,dimension] - np.dot(array[row,0:row],solution)) / array[row,row]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   solution.append(variable)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">solNumpy(array)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> np.array(solution)

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">LUGauss</span>(matriz):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimension</span> = checkSquare(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   checkDet(matriz)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">cont</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Etapa 0, matriz original---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(matriz,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">U</span> = np.zeros((dimension,dimension))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">L</span> = np.identity(dimension)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> col <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(0,dimension):          
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> row <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(col+1,dimension):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mult</span> = -(matriz[row,col]/matriz[col,col])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">L</span>[row,col] = -mult
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   sumMultRow(matriz,row,col,mult,col)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">U</span>[col] =  matriz[col]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">cont</span> += 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Etapa '</span> + <span style="color: #70c0b1;">str</span>(cont) + <span style="color: #b9ca4a;">'---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'L'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(L,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'U'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(U,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> L,U

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">LUGaussVector</span>(matriz, vector):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimension</span> = <span style="color: #70c0b1;">len</span>(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span> = np.zeros((dimension,dimension + 1))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,:-1] = matriz
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,-1:] = vector
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">numpySol</span> = solNumpy(array)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">L</span>, <span style="color: #e78c45;">U</span> = LUGauss(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Larr</span> = np.zeros((dimension,dimension + 1))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Larr</span>[:,:-1] = L
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Larr</span>[:,-1:] = vector
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Dado el sistema Lz = b'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(Larr,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Aplicamos sustituci&#243;n progresiva y obtenemos'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">pSus</span> = progSustitution(Larr)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(pSus)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Uarr</span> = np.zeros((dimension,dimension + 1))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Uarr</span>[:,:-1] = U
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Uarr</span>[:,-1] = pSus
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Dado el sistema Ux = z'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(Uarr,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Aplicamos sustituci&#243;n regresiva y obtenemos'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(sustitution(Uarr))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Opcional---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'La soluci&#243;n de  es: '</span> + <span style="color: #70c0b1;">str</span>(numpySol))


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">LUGaussPivoteoParcial</span>(matriz):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimension</span> = checkSquare(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   checkDet(matriz)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">cont</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Etapa 0, matriz original---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(matriz,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">A</span> = matriz
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">P</span> = np.identity(dimension)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">L</span> = np.zeros((dimension,dimension))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> col <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(0,dimension):  

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">maxRow</span> = np.argmax(<span style="color: #70c0b1;">abs</span>(A[col:,col])) + col
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   interRow(A,col,maxRow)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   interRow(P,col,maxRow)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   interRow(L,col,maxRow)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> row <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(col+1,dimension):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mult</span> = -(A[row,col]/A[col,col])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">L</span>[row,col] = -mult
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   sumMultRow(A,row,col,mult,col)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">U[col] =  matriz[col]</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">cont</span> += 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Etapa '</span> + <span style="color: #70c0b1;">str</span>(cont) + <span style="color: #b9ca4a;">'---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'P'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(P,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'A'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(A,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---&#218;ltima etapa---'</span>)     
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">U</span> = np.array(A, copy=<span style="color: #70c0b1;">True</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'U = A ='</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(U,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Se construye la matriz L con los multiplicadores almacenados'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   np.fill_diagonal(L, 1)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'L'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(L,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'P'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(P,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> L,U,P

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">LUGaussPivoteoParcialVector</span>(matriz, vector):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimension</span> = <span style="color: #70c0b1;">len</span>(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span> = np.zeros((dimension,dimension + 1))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,:-1] = matriz
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,-1:] = vector
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">numpySol</span> = solNumpy(array)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">L</span>, <span style="color: #e78c45;">U</span>, <span style="color: #e78c45;">P</span> = LUGaussPivoteoParcial(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Bn</span> = np.matmul(P,vector)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Calculamos el producto Pb = Bn'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(Bn,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Larr</span> = np.zeros((dimension,dimension + 1))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Larr</span>[:,:-1] = L
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Larr</span>[:,-1:] = Bn
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Dado el sistema Lz = Bn'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(Larr,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Aplicamos sustituci&#243;n progresiva y obtenemos'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">pSus</span> = progSustitution(Larr)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(pSus)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Uarr</span> = np.zeros((dimension,dimension + 1))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Uarr</span>[:,:-1] = U
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Uarr</span>[:,-1] = pSus
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Dado el sistema Ux = z'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(Uarr,floatfmt=<span style="color: #b9ca4a;">'.6f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Aplicamos sustituci&#243;n regresiva y obtenemos'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(sustitution(Uarr))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Opcional---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'La soluci&#243;n de  es: '</span> + <span style="color: #70c0b1;">str</span>(numpySol))


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">sustitution</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Sustituci&#243;n regresiva---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimension</span> = <span style="color: #70c0b1;">len</span>(array)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">solution</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">np.dot(A,B)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> row <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(dimension - 1, -1, -1):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">variable</span> = (array[row,dimension] - np.dot(array[row,row + 1:dimension],solution)) / array[row,row]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print('X' + str(row) + ' = ' + str(variable))</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   solution.insert(0,variable)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">solNumpy(array)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> np.array(solution)

<span style="color: #e78c45;">A</span> = np.array([[4,-1,0,3],[1,15.5,3,8],[0,-1.3,-4,1.1], [14,5,-2,30]],dtype=np.float64)
<span style="color: #e78c45;">x</span> = np.array([[1],[1],[1],[1]],dtype=np.float64)


<span style="color: #c397d8;">try</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   LUGaussVector(A,x) <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">LU con gauss simple si dan matriz y vector</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   LUGaussPivoteoParcialVector(A,x) <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">LU con pivoteo parcial si dan matriz y vector</span>

<span style="color: #c397d8;">except</span> <span style="color: #e7c547;">Exception</span> <span style="color: #c397d8;">as</span> msg:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(msg)

</pre>
</div>
</div>
<ol class="org-ol">
<li><a id="orgaadadf4"></a>LU con gaussiana simple<br />
<div class="outline-text-5" id="text-2-1-1-1">
<ul class="org-ul">
<li>Como ejecutarlo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #e78c45;">A</span> = np.array([[4,-1,0,3],[1,15.5,3,8],[0,-1.3,-4,1.1], [14,5,-2,30]],dtype=np.float64)
<span style="color: #e78c45;">x</span> = np.array([[1],[1],[1],[1]],dtype=np.float64)

LUGaussVector(A,x) <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">LU con gauss simple si dan matriz y vector</span>

</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
Determinante: -3297.5999999999976
---Etapa 0, matriz original---
---------  ---------  ---------  ---------
 4.000000  -1.000000   0.000000   3.000000
 1.000000  15.500000   3.000000   8.000000
 0.000000  -1.300000  -4.000000   1.100000
14.000000   5.000000  -2.000000  30.000000
---------  ---------  ---------  ---------
---Etapa 1---
L
--------  --------  --------  --------
1.000000  0.000000  0.000000  0.000000
0.250000  1.000000  0.000000  0.000000
0.000000  0.000000  1.000000  0.000000
3.500000  0.000000  0.000000  1.000000
--------  --------  --------  --------
U
--------  ---------  --------  --------
4.000000  -1.000000  0.000000  3.000000
0.000000   0.000000  0.000000  0.000000
0.000000   0.000000  0.000000  0.000000
0.000000   0.000000  0.000000  0.000000
--------  ---------  --------  --------
---Etapa 2---
L
--------  ---------  --------  --------
1.000000   0.000000  0.000000  0.000000
0.250000   1.000000  0.000000  0.000000
0.000000  -0.082540  1.000000  0.000000
3.500000   0.539683  0.000000  1.000000
--------  ---------  --------  --------
U
--------  ---------  --------  --------
4.000000  -1.000000  0.000000  3.000000
0.000000  15.750000  3.000000  7.250000
0.000000   0.000000  0.000000  0.000000
0.000000   0.000000  0.000000  0.000000
--------  ---------  --------  --------
---Etapa 3---
L
--------  ---------  --------  --------
1.000000   0.000000  0.000000  0.000000
0.250000   1.000000  0.000000  0.000000
0.000000  -0.082540  1.000000  0.000000
3.500000   0.539683  0.964467  1.000000
--------  ---------  --------  --------
U
--------  ---------  ---------  --------
4.000000  -1.000000   0.000000  3.000000
0.000000  15.750000   3.000000  7.250000
0.000000   0.000000  -3.752381  1.698413
0.000000   0.000000   0.000000  0.000000
--------  ---------  ---------  --------
---Etapa 4---
L
--------  ---------  --------  --------
1.000000   0.000000  0.000000  0.000000
0.250000   1.000000  0.000000  0.000000
0.000000  -0.082540  1.000000  0.000000
3.500000   0.539683  0.964467  1.000000
--------  ---------  --------  --------
U
--------  ---------  ---------  ---------
4.000000  -1.000000   0.000000   3.000000
0.000000  15.750000   3.000000   7.250000
0.000000   0.000000  -3.752381   1.698413
0.000000   0.000000   0.000000  13.949239
--------  ---------  ---------  ---------
Dado el sistema Lz = b
--------  ---------  --------  --------  --------
1.000000   0.000000  0.000000  0.000000  1.000000
0.250000   1.000000  0.000000  0.000000  1.000000
0.000000  -0.082540  1.000000  0.000000  1.000000
3.500000   0.539683  0.964467  1.000000  1.000000
--------  ---------  --------  --------  --------
Aplicamos sustitución progresiva y obtenemos
---Sustitución progresiva---
[ 1.          0.75        1.06190476 -3.92893401]
Dado el sistema Ux = z
--------  ---------  ---------  ---------  ---------
4.000000  -1.000000   0.000000   3.000000   1.000000
0.000000  15.750000   3.000000   7.250000   0.750000
0.000000   0.000000  -3.752381   1.698413   1.061905
0.000000   0.000000   0.000000  13.949239  -3.928934
--------  ---------  ---------  ---------  ---------
Aplicamos sustitución regresiva y obtenemos
---Sustitución regresiva---
[ 0.52510917  0.25545852 -0.41048035 -0.28165939]
---Opcional---
La solución de  es: [ 0.52510917  0.25545852 -0.41048035 -0.28165939]

</pre>
</div>
</li>
<li><a id="orgde6756c"></a>LU con pivoteo parcial<br />
<div class="outline-text-5" id="text-2-1-1-2">
<ul class="org-ul">
<li>Como ejecurlo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">A</span> = np.array([[4,-1,0,3],[1,15.5,3,8],[0,-1.3,-4,1.1], [14,5,-2,30]],dtype=np.float64)
<span style="color: #e78c45;">x</span> = np.array([[1],[1],[1],[1]],dtype=np.float64)

LUGaussPivoteoParcialVector(A,x) <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">LU con pivoteo parcial si dan matriz y vector</span>
</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
Determinante: -3297.5999999999976
---Etapa 0, matriz original---
---------  ---------  ---------  ---------
 4.000000  -1.000000   0.000000   3.000000
 1.000000  15.500000   3.000000   8.000000
 0.000000  -1.300000  -4.000000   1.100000
14.000000   5.000000  -2.000000  30.000000
---------  ---------  ---------  ---------
---Etapa 1---
P
--------  --------  --------  --------
0.000000  0.000000  0.000000  1.000000
0.000000  1.000000  0.000000  0.000000
0.000000  0.000000  1.000000  0.000000
1.000000  0.000000  0.000000  0.000000
--------  --------  --------  --------
A
---------  ---------  ---------  ---------
14.000000   5.000000  -2.000000  30.000000
 0.000000  15.142857   3.142857   5.857143
 0.000000  -1.300000  -4.000000   1.100000
 0.000000  -2.428571   0.571429  -5.571429
---------  ---------  ---------  ---------
---Etapa 2---
P
--------  --------  --------  --------
0.000000  0.000000  0.000000  1.000000
0.000000  1.000000  0.000000  0.000000
0.000000  0.000000  1.000000  0.000000
1.000000  0.000000  0.000000  0.000000
--------  --------  --------  --------
A
---------  ---------  ---------  ---------
14.000000   5.000000  -2.000000  30.000000
 0.000000  15.142857   3.142857   5.857143
 0.000000   0.000000  -3.730189   1.602830
 0.000000   0.000000   1.075472  -4.632075
---------  ---------  ---------  ---------
---Etapa 3---
P
--------  --------  --------  --------
0.000000  0.000000  0.000000  1.000000
0.000000  1.000000  0.000000  0.000000
0.000000  0.000000  1.000000  0.000000
1.000000  0.000000  0.000000  0.000000
--------  --------  --------  --------
A
---------  ---------  ---------  ---------
14.000000   5.000000  -2.000000  30.000000
 0.000000  15.142857   3.142857   5.857143
 0.000000   0.000000  -3.730189   1.602830
 0.000000   0.000000   0.000000  -4.169954
---------  ---------  ---------  ---------
---Etapa 4---
P
--------  --------  --------  --------
0.000000  0.000000  0.000000  1.000000
0.000000  1.000000  0.000000  0.000000
0.000000  0.000000  1.000000  0.000000
1.000000  0.000000  0.000000  0.000000
--------  --------  --------  --------
A
---------  ---------  ---------  ---------
14.000000   5.000000  -2.000000  30.000000
 0.000000  15.142857   3.142857   5.857143
 0.000000   0.000000  -3.730189   1.602830
 0.000000   0.000000   0.000000  -4.169954
---------  ---------  ---------  ---------
---Última etapa---
U = A =
---------  ---------  ---------  ---------
14.000000   5.000000  -2.000000  30.000000
 0.000000  15.142857   3.142857   5.857143
 0.000000   0.000000  -3.730189   1.602830
 0.000000   0.000000   0.000000  -4.169954
---------  ---------  ---------  ---------
Se construye la matriz L con los multiplicadores almacenados
L
--------  ---------  ---------  --------
1.000000   0.000000   0.000000  0.000000
0.071429   1.000000   0.000000  0.000000
0.000000  -0.085849   1.000000  0.000000
0.285714  -0.160377  -0.288316  1.000000
--------  ---------  ---------  --------
P
--------  --------  --------  --------
0.000000  0.000000  0.000000  1.000000
0.000000  1.000000  0.000000  0.000000
0.000000  0.000000  1.000000  0.000000
1.000000  0.000000  0.000000  0.000000
--------  --------  --------  --------
Calculamos el producto Pb = Bn
--------
1.000000
1.000000
1.000000
1.000000
--------
Dado el sistema Lz = Bn
--------  ---------  ---------  --------  --------
1.000000   0.000000   0.000000  0.000000  1.000000
0.071429   1.000000   0.000000  0.000000  1.000000
0.000000  -0.085849   1.000000  0.000000  1.000000
0.285714  -0.160377  -0.288316  1.000000  1.000000
--------  ---------  ---------  --------  --------
Aplicamos sustitución progresiva y obtenemos
---Sustitución progresiva---
[1.         0.92857143 1.07971698 1.17450683]
Dado el sistema Ux = z
---------  ---------  ---------  ---------  --------
14.000000   5.000000  -2.000000  30.000000  1.000000
 0.000000  15.142857   3.142857   5.857143  0.928571
 0.000000   0.000000  -3.730189   1.602830  1.079717
 0.000000   0.000000   0.000000  -4.169954  1.174507
---------  ---------  ---------  ---------  --------
Aplicamos sustitución regresiva y obtenemos
---Sustitución regresiva---
[ 0.52510917  0.25545852 -0.41048035 -0.28165939]
---Opcional---
La solución de  es: [ 0.52510917  0.25545852 -0.41048035 -0.28165939]

</pre>
</div>
</li>
</ol>
</div>
<div id="outline-container-org0c8e9b6" class="outline-4">
<h4 id="org0c8e9b6"><span class="section-number-4">2.1.2</span> Crout, Doolittle, Cholesky</h4>
<div class="outline-text-4" id="text-2-1-2">
<ul class="org-ul">
<li>Algoritmo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> math


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">matrizIdentidad</span>(n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">M</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">row</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> i == j: row.append(1)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>: row.append(0)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   M.append(row)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> M

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">valorMatriz</span>(Matriz):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">nuevaMatriz</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(Matriz)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fila</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(Matriz[0])):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   fila.append(Matriz[i][j])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   nuevaMatriz.append(fila)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> nuevaMatriz

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">matrizAumentada</span>(A, b):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">matrizAumentada</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">copiaDeA</span> = valorMatriz(A)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(copiaDeA)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   copiaDeA[i].append(b[i])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizAumentada.append(copiaDeA[i])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> matrizAumentada


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">sustitucionRegresiva</span>(Ab):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> pivotIndex <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>((<span style="color: #70c0b1;">len</span>(Ab) - 1), -1, -1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">summation</span> = <span style="color: #e78c45;">i</span> =  0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> column <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>((<span style="color: #70c0b1;">len</span>(Ab[0]) - 2), pivotIndex, -1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">summation</span> +=  Ab[pivotIndex][column] * x[i]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">i</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   x.append( ( Ab[pivotIndex][<span style="color: #70c0b1;">len</span>(Ab[0]) - 1] - summation ) / Ab[pivotIndex][pivotIndex] )

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> x[::-1]

<span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">***********************************************************************************************</span>

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">sustitucionProgresiva</span>(Ab):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> pivotIndex <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(Ab)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">summation</span> = <span style="color: #e78c45;">i</span> =  0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> column <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(pivotIndex):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">summation</span> += Ab[pivotIndex][column] * x[i]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">i</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   x.append( (Ab[pivotIndex][<span style="color: #70c0b1;">len</span>(Ab[0]) - 1] - summation) / Ab[pivotIndex][pivotIndex] )

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> x

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">imprimirMatriz</span>(Matriz): 
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> fila <span style="color: #c397d8;">in</span> Matriz: <span style="color: #c397d8;">print</span>(fila)

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">factorizacionDirecta</span>(A, n, b, metodo):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">etapas</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">L</span> = matrizIdentidad(n)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">U</span> = matrizIdentidad(n)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> metodo == <span style="color: #b9ca4a;">"Crout"</span>: 
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n): L[i][i] = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> metodo == <span style="color: #b9ca4a;">"Doolittle"</span>: 
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n): U[i][i] = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">suma1</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> p <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">suma1</span> += L[k][p] * U[p][k]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> metodo == <span style="color: #b9ca4a;">"Crout"</span>: 
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   L[k][k] = A[k][k] - suma1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> metodo == <span style="color: #b9ca4a;">"Doolittle"</span>: 
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   U[k][k] = A[k][k] - suma1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">elif</span> metodo == <span style="color: #b9ca4a;">"Cholesky"</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">try</span>:  
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   L[k][k] = math.sqrt(A[k][k] - suma1)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   U[k][k] = L[k][k]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">except</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"No se puede realizar el metodo porque hay un numero negativo en la raiz, no se trabaja con imaginarios"</span>)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k + 1, n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">suma2</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> p <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">suma2</span> += L[i][p] * U[p][k]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   L[i][k] = (A[i][k] - suma2) / <span style="color: #70c0b1;">float</span>(U[k][k])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k + 1, n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">suma3</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> p <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(k):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">suma3</span> += L[k][p] * U[p][j]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   U[k][j] = (A[k][j] - suma3) / <span style="color: #70c0b1;">float</span>(L[k][k])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   etapas.append([valorMatriz(L), valorMatriz(U)])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Lb</span> = matrizAumentada(L, b)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">z</span> = sustitucionProgresiva(Lb)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Uz</span> = matrizAumentada(U, z)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = sustitucionRegresiva(Uz)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [etapas, x, z, Lb, Uz]

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">imprimirResultados</span>(etapas, x):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contEtapa</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> etapa <span style="color: #c397d8;">in</span> etapas:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Resumen de la etapa "</span> + <span style="color: #70c0b1;">str</span>(contEtapa) + <span style="color: #b9ca4a;">": "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">L</span> = etapa[0]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">U</span> = etapa[1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"L: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> element <span style="color: #c397d8;">in</span> L:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(element)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"U: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> element <span style="color: #c397d8;">in</span> U:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(element)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contEtapa</span>+=1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print(etapas)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Resultado: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(x)

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">A</span> = [[4.0,-1.0,0.0,3.0], [1.0,15.5,3.0,8.0], [0.0,-1.3,-4.0,1.1], [14.0,5.0,-2.0,30.0]]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = [1,1,1,1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">n</span> = <span style="color: #70c0b1;">len</span>(A)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">etapas</span>, <span style="color: #e78c45;">x</span>, <span style="color: #e78c45;">z</span>, <span style="color: #e78c45;">Lb</span>, <span style="color: #e78c45;">Uz</span> = factorizacionDirecta(A,n,b,<span style="color: #b9ca4a;">"Crout"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"**************************************************************************************************"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Resultados Crout: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   imprimirResultados(etapas, x)


<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">etapas</span>, <span style="color: #e78c45;">x</span>, <span style="color: #e78c45;">z</span>, <span style="color: #e78c45;">Lb</span>, <span style="color: #e78c45;">Uz</span> = factorizacionDirecta(A,n,b,<span style="color: #b9ca4a;">"Doolittle"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"**************************************************************************************************"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Resultados Doolittle: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   imprimirResultados(etapas, x)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">etapas</span>, <span style="color: #e78c45;">x</span>, <span style="color: #e78c45;">z</span>, <span style="color: #e78c45;">Lb</span>, <span style="color: #e78c45;">Uz</span> = factorizacionDirecta(A,n,b,<span style="color: #b9ca4a;">"Cholesky"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"**************************************************************************************************"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Resultados Cholesky: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   imprimirResultados(etapas, x)      
</pre>
</div>
</div>
<ol class="org-ol">
<li><a id="org72f9ade"></a>Crout<br />
<div class="outline-text-5" id="text-2-1-2-1">
<ul class="org-ul">
<li>Como ejecutar Crout</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">A</span> = [[4.0,-1.0,0.0,3.0], [1.0,15.5,3.0,8.0], [0.0,-1.3,-4.0,1.1], [14.0,5.0,-2.0,30.0]]
<span style="color: #e78c45;">b</span> = [1,1,1,1]
<span style="color: #e78c45;">n</span> = <span style="color: #70c0b1;">len</span>(A)
<span style="color: #e78c45;">etapas</span>, <span style="color: #e78c45;">x</span>, <span style="color: #e78c45;">z</span>, <span style="color: #e78c45;">Lb</span>, <span style="color: #e78c45;">Uz</span> = factorizacionDirecta(A,n,b,<span style="color: #b9ca4a;">"Crout"</span>)
<span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"**************************************************************************************************"</span>)
<span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Resultados Crout: "</span>)
imprimirResultados(etapas, x)

</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
Resultados Crout: 
Resumen de la etapa 0: 
L: 
[4.0, 0, 0, 0]
[1.0, 0, 0, 0]
[0.0, 0, 0, 0]
[14.0, 0, 0, 0]
U: 
[1, -0.25, 0.0, 0.75]
[0, 1, 0, 0]
[0, 0, 1, 0]
[0, 0, 0, 1]
Resumen de la etapa 1: 
L: 
[4.0, 0, 0, 0]
[1.0, 15.75, 0, 0]
[0.0, -1.3, 0, 0]
[14.0, 8.5, 0, 0]
U: 
[1, -0.25, 0.0, 0.75]
[0, 1, 0.19047619047619047, 0.4603174603174603]
[0, 0, 1, 0]
[0, 0, 0, 1]
Resumen de la etapa 2: 
L: 
[4.0, 0, 0, 0]
[1.0, 15.75, 0, 0]
[0.0, -1.3, -3.7523809523809524, 0]
[14.0, 8.5, -3.619047619047619, 0]
U: 
[1, -0.25, 0.0, 0.75]
[0, 1, 0.19047619047619047, 0.4603174603174603]
[0, 0, 1, -0.45262267343485624]
[0, 0, 0, 1]
Resumen de la etapa 3: 
L: 
[4.0, 0, 0, 0]
[1.0, 15.75, 0, 0]
[0.0, -1.3, -3.7523809523809524, 0]
[14.0, 8.5, -3.619047619047619, 13.949238578680202]
U: 
[1, -0.25, 0.0, 0.75]
[0, 1, 0.19047619047619047, 0.4603174603174603]
[0, 0, 1, -0.45262267343485624]
[0, 0, 0, 1]
Resultado: 
[0.5251091703056769, 0.2554585152838428, -0.4104803493449782, -0.28165938864628826]

</pre>
</div>
</li>
<li><a id="org9e67f0c"></a>Doolittle<br />
<div class="outline-text-5" id="text-2-1-2-2">
<ul class="org-ul">
<li>Como ejecutar Doolittle</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">etapas</span>, <span style="color: #e78c45;">x</span>, <span style="color: #e78c45;">z</span>, <span style="color: #e78c45;">Lb</span>, <span style="color: #e78c45;">Uz</span> = factorizacionDirecta(A,n,b,<span style="color: #b9ca4a;">"Doolittle"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"**************************************************************************************************"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Resultados Doolittle: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   imprimirResultados(etapas, x)
</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
Resultados Doolittle: 
Resumen de la etapa 0: 
L: 
[1, 0, 0, 0]
[0.25, 1, 0, 0]
[0.0, 0, 1, 0]
[3.5, 0, 0, 1]
U: 
[4.0, -1.0, 0.0, 3.0]
[0, 0, 0, 0]
[0, 0, 0, 0]
[0, 0, 0, 0]
Resumen de la etapa 1: 
L: 
[1, 0, 0, 0]
[0.25, 1, 0, 0]
[0.0, -0.08253968253968254, 1, 0]
[3.5, 0.5396825396825397, 0, 1]
U: 
[4.0, -1.0, 0.0, 3.0]
[0, 15.75, 3.0, 7.25]
[0, 0, 0, 0]
[0, 0, 0, 0]
Resumen de la etapa 2: 
L: 
[1, 0, 0, 0]
[0.25, 1, 0, 0]
[0.0, -0.08253968253968254, 1, 0]
[3.5, 0.5396825396825397, 0.9644670050761421, 1]
U: 
[4.0, -1.0, 0.0, 3.0]
[0, 15.75, 3.0, 7.25]
[0, 0, -3.7523809523809524, 1.6984126984126986]
[0, 0, 0, 0]
Resumen de la etapa 3: 
L: 
[1, 0, 0, 0]
[0.25, 1, 0, 0]
[0.0, -0.08253968253968254, 1, 0]
[3.5, 0.5396825396825397, 0.9644670050761421, 1]
U: 
[4.0, -1.0, 0.0, 3.0]
[0, 15.75, 3.0, 7.25]
[0, 0, -3.7523809523809524, 1.6984126984126986]
[0, 0, 0, 13.949238578680202]
Resultado: 
[0.5251091703056769, 0.2554585152838428, -0.41048034934497823, -0.28165938864628826]
No se puede realizar el metodo porque hay un numero negativo en la raiz, no se trabaja con imaginarios

</pre>
</div>
</li>
<li><a id="orge436bf9"></a>Cholesky<br />
<div class="outline-text-5" id="text-2-1-2-3">
<ul class="org-ul">
<li>Como ejecutar Cholesky</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">etapas</span>, <span style="color: #e78c45;">x</span>, <span style="color: #e78c45;">z</span>, <span style="color: #e78c45;">Lb</span>, <span style="color: #e78c45;">Uz</span> = factorizacionDirecta(A,n,b,<span style="color: #b9ca4a;">"Cholesky"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"**************************************************************************************************"</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Resultados Cholesky: "</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   imprimirResultados(etapas, x) 
</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
Resultados Cholesky: 
Resumen de la etapa 0: 
L: 
[2.0, 0, 0, 0]
[0.5, 1, 0, 0]
[0.0, 0, 1, 0]
[7.0, 0, 0, 1]
U: 
[2.0, -0.5, 0.0, 1.5]
[0, 1, 0, 0]
[0, 0, 1, 0]
[0, 0, 0, 1]
Resumen de la etapa 1: 
L: 
[2.0, 0, 0, 0]
[0.5, 3.968626966596886, 0, 0]
[0.0, -0.32756920994133026, 1, 0]
[7.0, 2.141798680385621, 0, 1]
U: 
[2.0, -0.5, 0.0, 1.5]
[0, 3.968626966596886, 0.7559289460184544, 1.8268282862112648]
[0, 0, 1, 0]
[0, 0, 0, 1]
Resumen de la etapa 2: 
L: 
[2.0, 0, 0, 0]
[0.5, 3.968626966596886, 0, 0]
[0.0, -0.32756920994133026, 1, 0]
[7.0, 2.141798680385621, -3.6190476190476186, 1]
U: 
[2.0, -0.5, 0.0, 1.5]
[0, 3.968626966596886, 0.7559289460184544, 1.8268282862112648]
[0, 0, 1, 1.6984126984126986]
[0, 0, 0, 1]
Resumen de la etapa 3: 
L: 
[2.0, 0, 0, 0]
[0.5, 3.968626966596886, 0, 0]
[0.0, -0.32756920994133026, 1, 0]
[7.0, 2.141798680385621, -3.6190476190476186, 4.661967183459393]
U: 
[2.0, -0.5, 0.0, 1.5]
[0, 3.968626966596886, 0.7559289460184544, 1.8268282862112648]
[0, 0, 1, 1.6984126984126986]
[0, 0, 0, 4.661967183459393]
Resultado: 
[0.1774813938930236, -0.16055505320998817, 0.9885789803157822, 0.04317312373930581]

</pre>
</div>
</li>
</ol>
</div>
<div id="outline-container-org651464f" class="outline-4">
<h4 id="org651464f"><span class="section-number-4">2.1.3</span> Jacobi</h4>
<div class="outline-text-4" id="text-2-1-3">
<ul class="org-ul">
<li>Algoritmo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> math

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">jacobi</span>(x, A, b):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">newX</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">n</span> = <span style="color: #70c0b1;">len</span>(x)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">suma</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> j != i: <span style="color: #e78c45;">suma</span> += A[i][j] * x[j]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   newX.append( (b[i] - suma) / A[i][i] )

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> newX

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">norma2Euclidiana</span>(x):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">sumatoria</span> = 0.0

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">n</span> = <span style="color: #70c0b1;">len</span>(x)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(n):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">sumatoria</span> += math.<span style="color: #70c0b1;">pow</span>(math.fabs(x[j]), 2)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> math.sqrt(sumatoria)

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">disp</span>(x, y):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mayor</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(x)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> math.fabs(x[i]-y[i]) &gt; mayor: <span style="color: #e78c45;">mayor</span> = math.fabs(x[i]-y[i])

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> mayor

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">insertar</span>(tabla, xInicial, contador, dispersion):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">fila</span> = []

<span style="background-color: #2a2a2a;"> </span>   fila.append(contador)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> xInicial: fila.append(i)

<span style="background-color: #2a2a2a;"> </span>   fila.append(dispersion)

<span style="background-color: #2a2a2a;"> </span>   tabla.append(fila)

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">iterativo</span>(previus, tolerancia, maximoIteraciones, A, b):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contador</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dispersion</span> = tolerancia + 1

<span style="background-color: #2a2a2a;"> </span>   insertar(tabla, previus, contador, 0)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">while</span> contador &lt; maximoIteraciones <span style="color: #c397d8;">and</span> dispersion &gt; tolerancia :

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">current</span> = jacobi(previus, A, b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">elif metodo == "Seidel": current = seidel(previus, A, b)</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">dispersion = normaInfinito(current) - normaInfinito(previus)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dispersion</span> = disp(current, previus)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">previus</span> = current 

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">contador</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   insertar(tabla, previus, contador, dispersion)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> dispersion &lt; tolerancia:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #70c0b1;">str</span>(current) + <span style="color: #b9ca4a;">" Es una aprox con tolerancia: "</span>+<span style="color: #70c0b1;">str</span>(tolerancia), <span style="color: #70c0b1;">True</span>]

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = [<span style="color: #b9ca4a;">"Fracaso en "</span> + <span style="color: #70c0b1;">str</span>(maximoIteraciones) + <span style="color: #b9ca4a;">" iteraciones"</span>, <span style="color: #70c0b1;">False</span>]

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [tabla, mensaje]

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">A</span> = [[4.0,-1.0,0.0,3.0], [1.0,15.5,3.0,8.0], [0.0,-1.3,-4.0,1.1], [14.0,5.0,-2.0,30.0]]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = [1,1,1,1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x0</span> = [0,0,0,0]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tol</span> = 1e-7
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">nMax</span> = 100
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">resultado</span> = iterativo(x0, tol,nMax, A, b)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = resultado[0]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = resultado[1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> row <span style="color: #c397d8;">in</span> tabla:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(row)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Solucion: "</span> + mensaje[0])

</pre>
</div>
<ul class="org-ul">
<li>Como ejecutar</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">A</span> = [[4.0,-1.0,0.0,3.0], [1.0,15.5,3.0,8.0], [0.0,-1.3,-4.0,1.1], [14.0,5.0,-2.0,30.0]]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = [1,1,1,1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x0</span> = [0,0,0,0]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tol</span> = 1e-7
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">nMax</span> = 100
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">resultado</span> = iterativo(x0, tol,nMax, A, b)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = resultado[0]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mensaje</span> = resultado[1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> row <span style="color: #c397d8;">in</span> tabla:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(row)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"Solucion: "</span> + mensaje[0])
</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
[0, 0, 0, 0, 0, 0]
[1, 0.25, 0.06451612903225806, -0.25, 0.03333333333333333, 0.25]
[2, 0.2411290322580645, 0.07956989247311828, -0.2618010752688172, -0.110752688172043, 0.14408602150537633]
[3, 0.35295698924731184, 0.15679327089836975, -0.3063172043010753, -0.10990860215053762, 0.11182795698924733]
[4, 0.37162976933749564, 0.15775893166840096, -0.33118267863336803, -0.17793328708521214, 0.06802468493467452]
[5, 0.4228896982310093, 0.1964764234351165, -0.3502033067406637, -0.18846589287778936, 0.05125992889351366]
[6, 0.4404685255171211, 0.20228692677505142, -0.36568295815780494, -0.22010815019636798, 0.031642257318578615]
[7, 0.4656528443410388, 0.22048035809853145, -0.3762729925058929, -0.23031199691435209, 0.025184318823917695]
[8, 0.4778540872103969, 0.2261717489349327, -0.38499191553346956, -0.24580291987596622, 0.01549092296161414]
[9, 0.4908951271407078, 0.23506742054178978, -0.39110162136974386, -0.25302665988957196, 0.013041039930310916]
[10, 0.4985368500526264, 0.23913696877968385, -0.395979243145714, -0.26100240418061155, 0.007975744291039588]
[11, 0.5055360453303797, 0.24370452340834892, -0.39949517600306544, -0.2655719743642206, 0.006999195277753278]
[12, 0.5101051116252526, 0.24629195339306978, -0.4022362630578741, -0.2698339201224397, 0.00456906629487297]
[13, 0.5139484284400972, 0.24872742184050886, -0.4042492128864186, -0.27258012852782115, 0.0038433168148446217]
[14, 0.5166169518559931, 0.25028646699624046, -0.4057959474433162, -0.27491378443789144, 0.0026685234158958515]
[15, 0.5187569550774787, 0.25161813974045727, -0.40694439249419834, -0.27652205186172457, 0.0021400032214855536]
[16, 0.5202960738314077, 0.2525324282128331, -0.4078194596776229, -0.27781922849251284, 0.0015391187539290918]
[17, 0.5214975284225929, 0.2532720085897783, -0.4084733270046118, -0.278748203135304, 0.001201454591185147]
[18, 0.5223791544989226, 0.2538005211402371, -0.40896915865388656, -0.27947573649581386, 0.000881626076329689]
[19, 0.5230569326569197, 0.25421511054382245, -0.4093409969069259, -0.2800083028664625, 0.0006777781579970776]
[20, 0.5235600047858024, 0.25451822458035855, -0.4096221942150195, -0.2804184867909946, 0.0005030721288827866]
[21, 0.5239434212383356, 0.2547519014314331, -0.40983350685614006, -0.28072251927776887, 0.0003834164525331474]
[22, 0.5242298648161849, 0.25492498410014425, -0.4099930607666022, -0.28095448060687145, 0.00028644357784934904]
[23, 0.5244471064801897, 0.2550571072476512, -0.4101131019994365, -0.2811276383153505, 0.00021724166400471923]
[24, 0.5246100055484256, 0.25515569716393055, -0.410203660392208, -0.2812590410319928, 0.00016289906823596656]
[25, 0.5247332050649772, 0.2552305357344607, -0.41027183786207544, -0.28135752947606757, 0.00012319951655159755]
[26, 0.5248257810406658, 0.2552866157632122, -0.41032324471961834, -0.28143204084353785, 9.257597568856912e-05]
[27, 0.5248956845734565, 0.25532905031396724, -0.4103619613550169, -0.28148801676082064, 6.990353279068273e-05]
[28, 0.5249482751491072, 0.255360924746978, -0.410391145961265, -0.2815302919436087, 5.25905756507683e-05]
[29, 0.524987950144451, 0.2553849998892618, -0.4104131308272603, -0.28156209225816403, 3.9674995343741415e-05]
[30, 0.5250178191659385, 0.2554031084130737, -0.4104297003350052, -0.2815860854374381, 2.9869021487494152e-05]
[31, 0.525040341181347, 0.25541677195732787, -0.41044218372954444, -0.2816041470352839, 2.2522015408532603e-05]
[32, 0.5250573032657949, 0.25542705717997144, -0.41045159132083464, -0.2816177667928195, 1.696208444790237e-05]
[33, 0.5250700893896075, 0.25543481322833966, -0.4104586794515161, -0.2816280238087552, 1.2786123812613681e-05]
[34, 0.5250797211636513, 0.2554406541570956, -0.4104640208466181, -0.2816357558833078, 9.631774043783459e-06]
[35, 0.5250869804517547, 0.2554450573188816, -0.41046804546896576, -0.2816415802923277, 7.2592881034116985e-06]
[36, 0.5250924495489662, 0.25544837408346865, -0.4104710782090267, -0.2816459701285635, 5.469097211441287e-06]
[37, 0.5250965711172898, 0.2554508739423627, -0.4104733633624823, -0.2816492773506975, 4.121568323633973e-06]
[38, 0.5250996764986138, 0.255452757275854, -0.4104750853027097, -0.2816517697359612, 3.1053813239756423e-06]
[39, 0.5251020166209344, 0.25545417659981967, -0.4104763827920419, -0.28165364759884276, 2.3401223205876676e-06]
[40, 0.525103779849087, 0.25545524597070535, -0.41047736048462313, -0.28165506270920876, 1.763228152595886e-06]
[41, 0.5251051085245829, 0.2554560518244163, -0.41047809718551165, -0.28165612895699965, 1.328675495959608e-06]
[42, 0.5251061096738538, 0.2554566590121258, -0.4104786523061102, -0.28165693242790885, 1.0011492709294245e-06]
[43, 0.5251068640739631, 0.25545711655920955, -0.4104790705966158, -0.2816575378368934, 7.544001092707475e-07]
[44, 0.5251074325174725, 0.2554574613168408, -0.4104793857868888, -0.2816579940341588, 5.684435093744611e-07]
[45, 0.5251078608548293, 0.255457721104288, -0.4104796232873669, -0.2816583377800866, 4.28337356805919e-07]
[46, 0.525108183611137, 0.25545791685470737, -0.4104798022484174, -0.2816585968021261, 3.2275630768019425e-07]
[47, 0.5251084268152715, 0.25545806435813706, -0.4104799370983646, -0.281658791977543, 2.432041344979652e-07]
[48, 0.5251086100726915, 0.2554581755032365, -0.4104800387102189, -0.2816589390467072, 1.8325742001668033e-07]
[49, 0.5251087481608395, 0.25545825925365306, -0.4104801152763964, -0.2816590498651434, 1.380881480272933e-07]
[50, 0.5251088522122708, 0.25545832236061267, -0.41048017297035166, -0.2816591333690937, 1.0405143124891936e-07]
[51, 0.5251089306169734, 0.2554583699130022, -0.4104802164436999, -0.28165919629051855, 7.840470261921695e-08]
Solucion: [0.5251089306169734, 0.2554583699130022, -0.4104802164436999, -0.28165919629051855] Es una aprox con tolerancia: 1e-07

</pre>
</div>
</div>
<div id="outline-container-org2f751d2" class="outline-4">
<h4 id="org2f751d2"><span class="section-number-4">2.1.4</span> Gauss-Seidel, SOR</h4>
<div class="outline-text-4" id="text-2-1-4">
<ul class="org-ul">
<li>Algoritmo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> numpy <span style="color: #c397d8;">as</span> np
<span style="color: #c397d8;">from</span> tabulate <span style="color: #c397d8;">import</span> tabulate
<span style="color: #c397d8;">from</span> sympy <span style="color: #c397d8;">import</span> *
<span style="color: #c397d8;">import</span> matplotlib.pyplot <span style="color: #c397d8;">as</span> plt

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">solNumpy</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">A</span> = array[:,0:-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">B</span> = array[:,-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">solution</span> = np.linalg.solve(A, B)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> solution

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">checkSquare</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">rows</span> = <span style="color: #70c0b1;">len</span>(array)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span> (0,rows):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">len</span>(array[i]) != rows:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">raise</span> <span style="color: #e7c547;">Exception</span>(<span style="color: #b9ca4a;">'La matriz debe ser cuadrada'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> rows

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">checkDet</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">det</span> = np.linalg.det(array)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Determinante: '</span> + <span style="color: #70c0b1;">str</span>(det))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> det == 0: <span style="color: #c397d8;">raise</span> <span style="color: #e7c547;">Exception</span>(<span style="color: #b9ca4a;">'La determinante de la matriz debe ser diferente a cero'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tol</span> = 10e-4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">abs</span>(det) &lt; tol:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">option</span> = getOption(<span style="color: #b9ca4a;">'La determinante es menor a '</span> + <span style="color: #70c0b1;">str</span>(tol) 
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   + <span style="color: #b9ca4a;">' y puede presentar problemas de evaluaci&#243;n &#191;Desea continuar? si[s] no[n]'</span>,[<span style="color: #b9ca4a;">'s'</span>,<span style="color: #b9ca4a;">'n'</span>])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> option == <span style="color: #b9ca4a;">'n'</span>: <span style="color: #c397d8;">raise</span> <span style="color: #e7c547;">Exception</span>(<span style="color: #b9ca4a;">'Operaci&#243;n abortada por el usuario'</span>)


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">gauss_seidelMatricial</span>(matriz, vector, x0, tol, nMax):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimension</span> = checkSquare(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   checkDet(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span> = np.zeros((dimension,dimension + 1))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,:-1] = matriz
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,-1:] = vector
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(array))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">numpySol</span> = solNumpy(array)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">D</span> = np.triu(np.tril(matriz))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">L</span> = -np.tril(matriz,-1)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">U</span> = -np.triu(matriz,+1)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Tj</span> = np.dot(np.linalg.inv(D-L),U)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Tj---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(Tj, floatfmt=<span style="color: #b9ca4a;">'.8f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">radioS</span> = np.amax(<span style="color: #70c0b1;">abs</span>(np.linalg.eigvals(Tj)))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Radio espectral: '</span> + <span style="color: #70c0b1;">str</span>(radioS))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Cg</span> = np.dot(np.linalg.inv(D-L),vector)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Cg---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(Cg, floatfmt=<span style="color: #b9ca4a;">'.8f'</span>))


<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">table</span> = [[0,x0]]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> n <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(1,nMax):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   table.append([n])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   table[n].append(np.dot(Tj,table[n-1][1])+Cg)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">errorAbs</span> = <span style="color: #70c0b1;">abs</span>(np.linalg.norm(table[n][1])-np.linalg.norm(table[n-1][1]))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   table[n].append(errorAbs)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> errorAbs &lt; tol: <span style="color: #c397d8;">break</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(table, headers=[<span style="color: #b9ca4a;">'i'</span>,<span style="color: #b9ca4a;">'b'</span>,<span style="color: #b9ca4a;">'E'</span>], floatfmt=[<span style="color: #b9ca4a;">'i'</span>,<span style="color: #b9ca4a;">'.8f'</span>,<span style="color: #b9ca4a;">'.1E'</span>]))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'La soluci&#243;n es: '</span> + <span style="color: #70c0b1;">str</span>(numpySol))

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">SORMatricial</span>(matriz, vector, x0, tol, nMax, w):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimension</span> = checkSquare(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   checkDet(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span> = np.zeros((dimension,dimension + 1))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,:-1] = matriz
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,-1:] = vector
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(array))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">numpySol</span> = solNumpy(array)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">D</span> = np.triu(np.tril(matriz))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">L</span> = -np.tril(matriz,-1)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">U</span> = -np.triu(matriz,+1)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Tw</span> = np.dot(np.linalg.inv(D - w*L),((1-w)*D + w*U))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Tw---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(Tw, floatfmt=<span style="color: #b9ca4a;">'.8f'</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">radioS</span> = np.amax(<span style="color: #70c0b1;">abs</span>(np.linalg.eigvals(Tw)))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'Radio espectral: '</span> + <span style="color: #70c0b1;">str</span>(radioS))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">Cw</span> = w * np.dot((np.linalg.inv(D - w*L)),vector)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Cw---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(Cw, floatfmt=<span style="color: #b9ca4a;">'.8f'</span>))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">table</span> = [[0,x0]]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> n <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(1,nMax):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   table.append([n])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   table[n].append(np.dot(Tw,table[n-1][1])+Cw)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">errorAbs</span> = <span style="color: #70c0b1;">abs</span>(np.linalg.norm(table[n][1])-np.linalg.norm(table[n-1][1]))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   table[n].append(errorAbs)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> errorAbs &lt; tol: <span style="color: #c397d8;">break</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(table, headers=[<span style="color: #b9ca4a;">'i'</span>,<span style="color: #b9ca4a;">'b'</span>,<span style="color: #b9ca4a;">'E'</span>], floatfmt=[<span style="color: #b9ca4a;">'i'</span>,<span style="color: #b9ca4a;">'.8f'</span>,<span style="color: #b9ca4a;">'.1E'</span>]))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'La soluci&#243;n es: '</span> + <span style="color: #70c0b1;">str</span>(numpySol))

<span style="color: #e78c45;">A</span> = np.array([[4,-1,0,3],[1,15.5,3,8],[0,-1.3,-4,1.1], [14,5,-2,30]],dtype=np.float64)
<span style="color: #e78c45;">x</span> = np.array([[1],[1],[1],[1]],dtype=np.float64)

<span style="color: #e78c45;">x0</span> = np.array([[0],[0],[0],[0]],dtype=np.float64)
<span style="color: #e78c45;">tol</span> = 1e-7
<span style="color: #e78c45;">nMax</span> = 100
<span style="color: #e78c45;">w</span> = 1.5
gauss_seidelMatricial(A,x,x0,tol,nMax)
SORMatricial(A,x,x0,tol,nMax,1.5)

</pre>
</div>
</div>
<ol class="org-ol">
<li><a id="orgcfb1c0d"></a>Gauss-Seidel<br />
<div class="outline-text-5" id="text-2-1-4-1">
<ul class="org-ul">
<li>Como ejecutar</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">A</span> = np.array([[4,-1,0,3],[1,15.5,3,8],[0,-1.3,-4,1.1], [14,5,-2,30]],dtype=np.float64)
<span style="color: #e78c45;">x</span> = np.array([[1],[1],[1],[1]],dtype=np.float64)

<span style="color: #e78c45;">x0</span> = np.array([[0],[0],[0],[0]],dtype=np.float64)
<span style="color: #e78c45;">tol</span> = 1e-7
<span style="color: #e78c45;">nMax</span> = 100

gauss_seidelMatricial(A,x,x0,tol,nMax)
</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
Determinante: -3297.5999999999976
--  ----  --  ----  -
 4  -1     0   3    1
 1  15.5   3   8    1
 0  -1.3  -4   1.1  1
14   5    -2  30    1
--  ----  --  ----  -
---Tj---
----------  -----------  -----------  -----------
0.00000000   0.25000000   0.00000000  -0.75000000
0.00000000  -0.01612903  -0.19354839  -0.46774194
0.00000000   0.00524194   0.06290323   0.42701613
0.00000000  -0.11362903   0.03645161   0.45642473
----------  -----------  -----------  -----------
Radio espectral: 0.5994876461601171
---Cg---
-----------
 0.25000000
 0.04838710
-0.26572581
-0.10911290
-----------
  i  b                      E
---  ---------------  -------
  0  [[0.]
      [0.]
      [0.]
      [0.]]
  1  [[ 0.25      ]   3.8E-01
      [ 0.0483871 ]
      [-0.26572581]
      [-0.1091129 ]]
  2  [[ 0.34393145]   1.4E-01
      [ 0.15007414]
      [-0.32878014]
      [-0.17409904]]
  3  [[ 0.41809282]   9.5E-02
      [ 0.19103484]
      [-0.35996356]
      [-0.21761336]]
  4  [[ 0.46096873]   5.8E-02
      [ 0.21676315]
      [-0.3802917 ]
      [-0.24326538]]
  5  [[ 0.48663982]   3.5E-02
      [ 0.23228118]
      [-0.39238936]
      [-0.25863807]]
  6  [[ 0.50204885]   2.1E-02
      [ 0.24156283]
      [-0.39963339]
      [-0.26785883]]
  7  [[ 0.51128483]   1.3E-02
      [ 0.24712813]
      [-0.40397782]
      [-0.27338613]]
  8  [[ 0.51682163]   7.5E-03
      [ 0.25046457]
      [-0.40658217]
      [-0.27669967]]
  9  [[ 0.52014089]   4.5E-03
      [ 0.25246471]
      [-0.40814344]
      [-0.2786861 ]]
 10  [[ 0.52213075]   2.7E-03
      [ 0.25366376]
      [-0.4090794 ]
      [-0.27987694]]
 11  [[ 0.52332364]   1.6E-03
      [ 0.25438258]
      [-0.4096405 ]
      [-0.28059083]]
 12  [[ 0.52403877]   9.7E-04
      [ 0.25481351]
      [-0.40997687]
      [-0.2810188 ]]
 13  [[ 0.52446748]   5.8E-04
      [ 0.25507184]
      [-0.41017852]
      [-0.28127536]]
 14  [[ 0.52472448]   3.5E-04
      [ 0.25522671]
      [-0.41029941]
      [-0.28142917]]
 15  [[ 0.52487856]   2.1E-04
      [ 0.25531955]
      [-0.41037188]
      [-0.28152138]]
 16  [[ 0.52497092]   1.3E-04
      [ 0.25537521]
      [-0.41041532]
      [-0.28157665]]
 17  [[ 0.52502629]   7.5E-05
      [ 0.25540857]
      [-0.41044137]
      [-0.28160979]]
 18  [[ 0.52505948]   4.5E-05
      [ 0.25542858]
      [-0.41045698]
      [-0.28162965]]
 19  [[ 0.52507938]   2.7E-05
      [ 0.25544057]
      [-0.41046634]
      [-0.28164156]]
 20  [[ 0.52509131]   1.6E-05
      [ 0.25544776]
      [-0.41047195]
      [-0.2816487 ]]
 21  [[ 0.52509847]   9.7E-06
      [ 0.25545206]
      [-0.41047531]
      [-0.28165298]]
 22  [[ 0.52510275]   5.8E-06
      [ 0.25545465]
      [-0.41047733]
      [-0.28165555]]
 23  [[ 0.52510532]   3.5E-06
      [ 0.2554562 ]
      [-0.41047854]
      [-0.28165709]]
 24  [[ 0.52510686]   2.1E-06
      [ 0.25545713]
      [-0.41047926]
      [-0.28165801]]
 25  [[ 0.52510779]   1.3E-06
      [ 0.25545768]
      [-0.4104797 ]
      [-0.28165856]]
 26  [[ 0.52510834]   7.5E-07
      [ 0.25545802]
      [-0.41047996]
      [-0.28165889]]
 27  [[ 0.52510867]   4.5E-07
      [ 0.25545822]
      [-0.41048012]
      [-0.28165909]]
 28  [[ 0.52510887]   2.7E-07
      [ 0.25545834]
      [-0.41048021]
      [-0.28165921]]
 29  [[ 0.52510899]   1.6E-07
      [ 0.25545841]
      [-0.41048027]
      [-0.28165928]]
 30  [[ 0.52510906]   9.7E-08
      [ 0.25545845]
      [-0.4104803 ]
      [-0.28165932]]
La solución es: [ 0.52510917  0.25545852 -0.41048035 -0.28165939]

</pre>
</div>
</li>
<li><a id="orga6e5819"></a>SOR<br />
<div class="outline-text-5" id="text-2-1-4-2">
<ul class="org-ul">
<li>Como ejecutar</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">A</span> = np.array([[4,-1,0,3],[1,15.5,3,8],[0,-1.3,-4,1.1], [14,5,-2,30]],dtype=np.float64)
<span style="color: #e78c45;">x</span> = np.array([[1],[1],[1],[1]],dtype=np.float64)

<span style="color: #e78c45;">x0</span> = np.array([[0],[0],[0],[0]],dtype=np.float64)
<span style="color: #e78c45;">tol</span> = 1e-7
<span style="color: #e78c45;">nMax</span> = 100
<span style="color: #e78c45;">w</span> = 1.5
gauss_seidelMatricial(A,x,x0,tol,nMax)
SORMatricial(A,x,x0,tol,nMax,w)
</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
Determinante: -3297.5999999999976
--  ----  --  ----  -
 4  -1     0   3    1
 1  15.5   3   8    1
 0  -1.3  -4   1.1  1
14   5    -2  30    1
--  ----  --  ----  -
---Tw---
-----------  -----------  -----------  -----------
-0.50000000   0.37500000   0.00000000  -1.12500000
 0.04838710  -0.53629032  -0.29032258  -0.66532258
-0.02358871   0.26144153  -0.35846774   0.73684476
 0.33554435  -0.10228327   0.03673387   0.52751512
-----------  -----------  -----------  -----------
Radio espectral: 0.6312081938144991
---Cw---
-----------
 0.37500000
 0.06048387
-0.40448589
-0.26806956
-----------
  i  b                      E
---  ---------------  -------
  0  [[0.]
      [0.]
      [0.]
      [0.]]
  1  [[ 0.375     ]   6.2E-01
      [ 0.06048387]
      [-0.40448589]
      [-0.26806956]]
  2  [[ 0.5117597 ]   2.0E-01
      [ 0.34197623]
      [-0.45004916]
      [-0.30469599]]
  3  [[ 0.59014422]   1.4E-02
      [ 0.23522845]
      [-0.39033638]
      [-0.30859371]]
  4  [[ 0.51530648]   2.2E-02
      [ 0.28152633]
      [-0.4443708 ]
      [-0.27123634]]
  5  [[ 0.52806002]   3.3E-02
      [ 0.24390875]
      [-0.38360511]
      [-0.28336154]]
  6  [[ 0.52121751]   1.9E-02
      [ 0.25512531]
      [-0.42445767]
      [-0.27939858]]
  7  [[ 0.52438664]   7.0E-03
      [ 0.25800267]
      [-0.40379938]
      [-0.28225196]]
  8  [[ 0.52709114]   4.7E-03
      [ 0.25251377]
      [-0.41262971]
      [-0.28222923]]
  9  [[ 0.52365497]   1.8E-03
      [ 0.25813679]
      [-0.41094639]
      [-0.2810727 ]]
 10  [[ 0.5261806 ]   3.3E-04
      [ 0.25369679]
      [-0.40914648]
      [-0.28212891]]
 11  [[ 0.52444102]   8.2E-04
      [ 0.25638029]
      [-0.41179033]
      [-0.28131836]]
 12  [[ 0.52540526]   8.0E-04
      [ 0.25508527]
      [-0.40950273]
      [-0.28184609]]
 13  [[ 0.5250312 ]   6.3E-04
      [ 0.2555134 ]
      [-0.41107293]
      [-0.28158444]]
 14  [[ 0.52508442]   3.9E-04
      [ 0.25554748]
      [-0.41019651]
      [-0.2816734 ]]
 15  [[ 0.52517067]   1.9E-04
      [ 0.25533652]
      [-0.41056857]
      [-0.28167376]]
 16  [[ 0.52504884]   6.2E-05
      [ 0.25556209]
      [-0.41049266]
      [-0.2816371 ]]
 17  [[ 0.5251531 ]   4.0E-06
      [ 0.25538879]
      [-0.41043101]
      [-0.28167892]]
 18  [[ 0.52508303]   3.0E-05
      [ 0.2554967 ]
      [-0.41053169]
      [-0.28164601]]
 19  [[ 0.52512151]   3.2E-05
      [ 0.25544277]
      [-0.41044149]
      [-0.28166689]]
 20  [[ 0.52510554]   2.5E-05
      [ 0.25546126]
      [-0.41050422]
      [-0.28165617]]
 21  [[ 0.52510839]   1.6E-05
      [ 0.25546165]
      [-0.41046862]
      [-0.28166007]]
 22  [[ 0.5251115 ]   7.8E-06
      [ 0.25545384]
      [-0.41048422]
      [-0.2816599 ]]
 23  [[ 0.52510682]   2.7E-06
      [ 0.2554626 ]
      [-0.41048062]
      [-0.28165854]]
 24  [[ 0.52511092]   2.1E-08
      [ 0.25545573]
      [-0.41047851]
      [-0.28166015]]
La solución es: [ 0.52510917  0.25545852 -0.41048035 -0.28165939]
</pre>
</div>
</li>
</ol>
</div>
<div id="outline-container-org02bc5bd" class="outline-4">
<h4 id="org02bc5bd"><span class="section-number-4">2.1.5</span> Vandermonde</h4>
<div class="outline-text-4" id="text-2-1-5">
<ul class="org-ul">
<li>Algoritmo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> numpy <span style="color: #c397d8;">as</span> np
<span style="color: #c397d8;">import</span> tabulate <span style="color: #c397d8;">as</span> tb
<span style="color: #c397d8;">from</span> tabulate <span style="color: #c397d8;">import</span> tabulate
<span style="color: #c397d8;">from</span> sympy <span style="color: #c397d8;">import</span> *
<span style="color: #e78c45;">tb.PRESERVE_WHITESPACE</span> = <span style="color: #70c0b1;">True</span>

<span style="color: #e78c45;">x</span> = symbols(<span style="color: #b9ca4a;">'x'</span>)
init_printing(use_unicode=<span style="color: #70c0b1;">False</span>)

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">vandermonde</span>(puntos):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---puntos---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(puntos)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">grado</span> = <span style="color: #70c0b1;">len</span>(puntos) - 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">matriz</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> puntos:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">row</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(grado,-1,-1):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   row.append(i[0]**j)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matriz.append(row)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">matriz</span> = np.array(matriz,dtype=np.float64)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---matriz A---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(matriz))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">vector</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> puntos:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   vector.append([i[1]])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">vector</span> = np.array(vector,dtype=np.float64)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---vector x---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(tabulate(vector))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">sol</span> = gauss(matriz, vector)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Coeficientes---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(sol)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">expr</span> = sympify(<span style="color: #b9ca4a;">'0'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">aux</span> = grado
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> sol:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">expr</span> = expr + sympify(<span style="color: #70c0b1;">str</span>(j) + <span style="color: #b9ca4a;">'*x**'</span> + <span style="color: #70c0b1;">str</span>(grado))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">grado</span> += -1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Polinomio---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(pretty(expr))


<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">checkSquare</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">rows</span> = <span style="color: #70c0b1;">len</span>(array)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span> (0,rows):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">len</span>(array[i]) != rows:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">raise</span> <span style="color: #e7c547;">Exception</span>(<span style="color: #b9ca4a;">'La matriz debe ser cuadrada'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> rows

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">checkDet</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">det</span> = np.linalg.det(array)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print('Determinante: ' + str(det))</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> det == 0: <span style="color: #c397d8;">raise</span> <span style="color: #e7c547;">Exception</span>(<span style="color: #b9ca4a;">'La determinante de la matriz debe ser diferente a cero'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tol</span> = 10e-4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">abs</span>(det) &lt; tol:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">option</span> = getOption(<span style="color: #b9ca4a;">'La determinante es menor a '</span> + <span style="color: #70c0b1;">str</span>(tol) 
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   + <span style="color: #b9ca4a;">' y puede presentar problemas de evaluaci&#243;n &#191;Desea continuar? si[s] no[n]'</span>,[<span style="color: #b9ca4a;">'s'</span>,<span style="color: #b9ca4a;">'n'</span>])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> option == <span style="color: #b9ca4a;">'n'</span>: <span style="color: #c397d8;">raise</span> <span style="color: #e7c547;">Exception</span>(<span style="color: #b9ca4a;">'Operaci&#243;n abortada por el usuario'</span>)

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">pivoteoTotal</span>(array, col, dimension, orden):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">subArray</span> = array[col:,col:-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimSubArray</span> = <span style="color: #70c0b1;">len</span>(subArray)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">index</span> = np.argmax(<span style="color: #70c0b1;">abs</span>(array[col:,col:-1]))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">rowCol</span> = getRowCol(index,dimSubArray,col)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   interCol(array,col,rowCol[1])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   inter1D(orden,col,rowCol[1])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   interRow(array,col,rowCol[0])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span>
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">getRowCol</span>(index, dimSub, corner):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">row</span> = <span style="color: #70c0b1;">int</span>(index / dimSub) 
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">col</span> = index % dimSub
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> [row + corner,col + corner]
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">interCol</span>(array, col1, col2):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> col1 != col2:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">aux</span> = array[:,col1].copy()
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,col1] = array[:,col2]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,col2] = aux
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">interRow</span>(array, row1, row2):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> row1 != row2:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">aux</span> = array[row1].copy()
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[row1] = array[row2]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[row2] = aux
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">inter1D</span>(array, pos1, pos2):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">aux</span> = array[pos1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[pos1] = array[pos2]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[pos2] = aux

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">sumMultRow</span>(array, rowAct, rowMult, mult, init):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[rowAct,init:] = array[rowAct,init:] + mult * array[rowMult,init:]

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">sustitution</span>(array):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print('---Sustituci&#243;n regresiva---')</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimension</span> = <span style="color: #70c0b1;">len</span>(array)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">solution</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">np.dot(A,B)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> row <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(dimension - 1, -1, -1):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">variable</span> = (array[row,dimension] - np.dot(array[row,row + 1:dimension],solution)) / array[row,row]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print('X' + str(row) + ' = ' + str(variable))</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   solution.insert(0,variable)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">solNumpy(array)</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> np.array(solution)



<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">gauss</span>(matriz, vector):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">dimension</span> = checkSquare(matriz)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   checkDet(matriz)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span> = np.zeros((dimension,dimension + 1))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,:-1] = matriz
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">array</span>[:,-1:] = vector

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">orden</span> = np.arange(dimension)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">cont</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print('---Etapa 0, matriz original---')</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print(tabulate(array,floatfmt='.6f'))</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> col <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(0,dimension-1):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   pivoteoTotal(array, col, dimension, orden)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> row <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(col+1,dimension):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">mult</span> = -(array[row,col]/array[col,col])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   sumMultRow(array,row,col,mult,col)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">cont</span> += 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print('---Etapa ' + str(cont) + ', haciendo 0 la columna ' </span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#       </span><span style="color: #969896; font-style: italic;">+ str(col) + '---')</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print(tabulate(array,floatfmt='.6f'))</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">sol</span> = sustitution(array)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(0,<span style="color: #70c0b1;">len</span>(orden)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   inter1D(sol,i,orden[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   inter1D(orden,i,orden[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   np.set_printoptions(precision=6)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print('Despu&#233;s de aplicar sustituci&#243;n regresiva: ' + str(sol))</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> sol

</pre>
</div>
<ul class="org-ul">
<li>Como ejecutar</li>
</ul>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #e78c45;">puntos</span> = [[-1,15.5],[0,3],[3,8],[4,1]]

vandermonde(puntos)

</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
---puntos---
[[-1, 15.5], [0, 3], [3, 8], [4, 1]]
---matriz A---
--  --  --  -
-1   1  -1  1
 0   0   0  1
27   9   3  1
64  16   4  1
--  --  --  -
---vector x---
----
15.5
 3
 8
 1
----
---Coeficientes---
[-1.141667  5.825    -5.533333  3.      ]
---Polinomio---
                      3                      2                            
- 1.1416666666666666*x  + 5.824999999999999*x  - 5.533333333333332*x + 3.0

</pre>
</div>
</div>
</div>
<div id="outline-container-orgbcecbff" class="outline-3">
<h3 id="orgbcecbff"><span class="section-number-3">2.2</span> Interpolación</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-org90f23e0" class="outline-4">
<h4 id="org90f23e0"><span class="section-number-4">2.2.1</span> Newton</h4>
<div class="outline-text-4" id="text-2-2-1">
<ul class="org-ul">
<li>Algoritmo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">calcularB</span>(x, y):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">diferenciasGradoAnterior</span> = y <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">Diferencias divididas de orden 0.</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = []
<span style="background-color: #2a2a2a;"> </span>   b.append(diferenciasGradoAnterior[0])

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">En este ciclo se buscan los bi.</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> orden <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(1, <span style="color: #70c0b1;">len</span>(x)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">diferencias</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">i</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">j</span> = i + orden

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> diferencia <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(diferenciasGradoAnterior) - 1):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">numerador</span> = diferenciasGradoAnterior[i] - diferenciasGradoAnterior[i + 1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">denominador</span> = x[i] - x[j]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   diferencias.append(numerador/denominador)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">i</span> += 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">j</span> += 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   b.append(diferencias[0])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">diferenciasGradoAnterior</span> = diferencias

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> b

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">p</span>(xEval, b, x):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">sumatoria</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(b)):

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">productorio</span> = 1

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> j <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(i): <span style="color: #e78c45;">productorio</span> *= xEval - x[j]

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">sumatoria</span> += b[i] * productorio

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> sumatoria

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span>==(<span style="color: #b9ca4a;">"__main__"</span>):
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = [-1,0,3,4]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">y</span> = [15.5,3,8,1]

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">resultado</span> = calcularB(x,y)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(resultado)

</pre>
</div>
<ul class="org-ul">
<li>Como ejecutarlo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">x</span> = [-1,0,3,4]
<span style="color: #e78c45;">y</span> = [15.5,3,8,1]

<span style="color: #e78c45;">resultado</span> = calcularB(x,y)
<span style="color: #c397d8;">print</span>(resultado)

</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
[15.5, -12.5, 3.5416666666666665, -1.1416666666666666]
</pre>
</div>
</div>
<div id="outline-container-org44b6e2b" class="outline-4">
<h4 id="org44b6e2b"><span class="section-number-4">2.2.2</span> Lagrange</h4>
<div class="outline-text-4" id="text-2-2-2">
<ul class="org-ul">
<li>Algortimo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> numpy <span style="color: #c397d8;">as</span> np
<span style="color: #c397d8;">import</span> tabulate <span style="color: #c397d8;">as</span> tb
<span style="color: #c397d8;">from</span> tabulate <span style="color: #c397d8;">import</span> tabulate
<span style="color: #c397d8;">from</span> sympy <span style="color: #c397d8;">import</span> *
<span style="color: #e78c45;">tb.PRESERVE_WHITESPACE</span> = <span style="color: #70c0b1;">True</span>

<span style="color: #e78c45;">x</span> = symbols(<span style="color: #b9ca4a;">'x'</span>)
init_printing(use_unicode=<span style="color: #70c0b1;">False</span>)

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">lagrange</span>(puntos):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---puntos---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(puntos)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>()
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">tabla</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #70c0b1;">sum</span> = sympify(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Lk(x) (Opcional)---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(0, <span style="color: #70c0b1;">len</span>(puntos)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">numerador</span> = sympify(1)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">denominador</span> = sympify(1)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> n <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(0, <span style="color: #70c0b1;">len</span>(puntos)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> n != k:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">numerador</span> *= sympify(<span style="color: #b9ca4a;">'x - '</span> + <span style="color: #70c0b1;">str</span>(puntos[n][0]))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">denominador</span> *= sympify(<span style="color: #70c0b1;">str</span>(puntos[k][0]) + <span style="color: #b9ca4a;">' - '</span> + <span style="color: #70c0b1;">str</span>(puntos[n][0]))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">lk</span> = numerador / denominador
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'L'</span> + <span style="color: #70c0b1;">str</span>(k) + <span style="color: #b9ca4a;">'(x) = '</span> + <span style="color: #70c0b1;">str</span>(lk))

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #70c0b1;">sum</span> += sympify(lk * puntos[k][1])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>()
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Polinomio expandido---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(pretty(<span style="color: #70c0b1;">sum</span>))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>()
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">poli</span> = simplify(<span style="color: #70c0b1;">sum</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">'---Polinomio simplificado---'</span>)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(pretty(poli))
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>()


<span style="color: #e78c45;">puntos</span> = [[-1,15.5],[0,3],[3,8],[4,1]]

lagrange(puntos)

</pre>
</div>
<ul class="org-ul">
<li>Como ejecutarlo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">puntos</span> = [[-1,15.5],[0,3],[3,8],[4,1]]
lagrange(puntos)
</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
[[-1, 15.5], [0, 3], [3, 8], [4, 1]]

---Lk(x) (Opcional)---
L0(x) = -x*(x - 4)*(x - 3)/20
L1(x) = (x - 4)*(x - 3)*(x + 1)/12
L2(x) = -x*(x - 4)*(x + 1)/12
L3(x) = x*(x - 3)*(x + 1)/20

---Polinomio expandido---
                           2*x*(x - 4)*(x + 1)   x*(x - 3)*(x + 1)   (x - 4)*(x - 3)*(x + 1)
-0.775*x*(x - 4)*(x - 3) - ------------------- + ----------------- + -----------------------
                                    3                    20                     4           

---Polinomio simplificado---
                    3          2                           
- 1.14166666666667*x  + 5.825*x  - 5.53333333333333*x + 3.0

</pre>
</div>
</div>
<div id="outline-container-orge28cf76" class="outline-4">
<h4 id="orge28cf76"><span class="section-number-4">2.2.3</span> Trazadores lineales</h4>
<div class="outline-text-4" id="text-2-2-3">
<ul class="org-ul">
<li>Algoritmo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> numpy <span style="color: #c397d8;">as</span> np

<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Este metodo recive 2 listas, los X y los Y de los puntos</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Retornara una lista con las pendientes de las rectas de 1 punto a otro y una lista de strings con las ecuaciones resultantes</span>
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">spline_lineal</span>(X,Y):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">pendientes</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuaciones</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(X)-1):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">m</span> = ( Y[i+1] - Y[i] ) / ( X[i+1] - X[i] )
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   pendientes.append(m)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">corte</span> = (m*(-X[i+1])) + Y[i+1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = <span style="color: #70c0b1;">str</span>(m)+<span style="color: #b9ca4a;">"X "</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> corte &lt; 0 :
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion + <span style="color: #70c0b1;">str</span>(corte)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion +<span style="color: #b9ca4a;">"+"</span>+<span style="color: #70c0b1;">str</span>(corte)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion +<span style="color: #b9ca4a;">"    "</span>+<span style="color: #70c0b1;">str</span>(Y[i]) + <span style="color: #b9ca4a;">" &lt;= X &lt;= "</span> + <span style="color: #70c0b1;">str</span>(Y[i+1])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecuaciones.append( ecuacion )

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> pendientes, ecuaciones

<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Recive las listas de X y de Y, el valor de X a evaluar y la lista de las pendientes</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Retorna el valor de F de X a evaluar</span>
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">evaluar_recta</span>(X,Y,X_eval,M):
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">j</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(X)-1):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = X[i]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = X[i+1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> X[i] &lt;= X_eval <span style="color: #c397d8;">and</span> X_eval &lt;= X[i+1]:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">G</span> = ( M[j] ) * ( X_eval-X[j] ) + ( Y[j] )
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">j</span> = j+1
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> G

<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">mainLineal</span>(xs, ys, valor_evaluar):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">M</span>, <span style="color: #e78c45;">ecuaciones</span> = spline_lineal(xs,ys)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">evaluacion</span> = evaluar_recta(xs,ys,valor_evaluar,M)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">imprimir ecuaciones</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> x <span style="color: #c397d8;">in</span> ecuaciones:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(x)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">imprimir el valor de F de X a evaluar</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"&gt; Al evaluar"</span>,valor_evaluar, <span style="color: #b9ca4a;">"se obtiene:"</span>, evaluacion)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> evaluacion, ecuaciones


<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = [-1,0,3,4]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">y</span> = [15.5,3,8,1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">valor</span> = 1

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">evaluacion</span>, <span style="color: #e78c45;">ecuaciones</span> = mainLineal(x,y,valor)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print(ecuaciones)</span>

</pre>
</div>
<ul class="org-ul">
<li>Como ejecutarlo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">x</span> = [-1,0,3,4]
<span style="background-color: #2a2a2a;"> </span>  <span style="color: #e78c45;">y</span> = [15.5,3,8,1]
<span style="background-color: #2a2a2a;"> </span>  <span style="color: #e78c45;">valor</span> = 1

<span style="background-color: #2a2a2a;"> </span>  <span style="color: #e78c45;">evaluacion</span>, <span style="color: #e78c45;">ecuaciones</span> = mainLineal(x,y,valor)
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">print(ecuaciones)</span>
</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
-12.5X +3.0    15.5 &lt;= X &lt;= 3
1.6666666666666667X +3.0    3 &lt;= X &lt;= 8
-7.0X +29.0    8 &lt;= X &lt;= 1
&gt; Al evaluar 1 se obtiene: 4.666666666666667

</pre>
</div>
</div>
<div id="outline-container-org5c73a3d" class="outline-4">
<h4 id="org5c73a3d"><span class="section-number-4">2.2.4</span> Trazadores cuadráticos</h4>
<div class="outline-text-4" id="text-2-2-4">
<ul class="org-ul">
<li>Algoritmo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> numpy <span style="color: #c397d8;">as</span> np

<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Este metodo recive 2 listas, los X y los Y de los puntos</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Retornara una lista con los Xs resultantes de la matriz generada y una lista de strings con las ecuaciones resultantes</span>
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">spline_cuadratico</span>(X,Y):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">k</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu1</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu1y</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(2,<span style="color: #70c0b1;">len</span>(X)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu11</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = (X[i-1])**2
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = (X[i-1])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">c</span> = 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">d</span> = Y[i-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (3* (<span style="color: #70c0b1;">len</span>(X)-1))-3

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu11.append(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> a == ((X[1])**2):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu11.insert(k,c)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu11.insert(k,b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu11.insert(k,a)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu1.append(ecu11)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu1y.append(d)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">k</span> = k+3

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">k</span> = 3
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu2</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu2y</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(2,<span style="color: #70c0b1;">len</span>(X)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu22</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = (X[i-1])**2
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = (X[i-1])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">c</span> = 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">d</span> = Y[i-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (3* (<span style="color: #70c0b1;">len</span>(X)-1))-3
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu22.append(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu22.insert(k,c)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu22.insert(k,b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu22.insert(k,a)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu2.append(ecu22)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu2y.append(d)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">k</span> = k+3

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu3</span> = [0,X[0],1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (3* (<span style="color: #70c0b1;">len</span>(X)-1)) - 3
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu3.append(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu3y</span>=Y[0]

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = (X[<span style="color: #70c0b1;">len</span>(X)-1])**2
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu4</span> = [a, X[<span style="color: #70c0b1;">len</span>(X)-1],1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (3*(<span style="color: #70c0b1;">len</span>(X)-1)) -3
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu4.insert(0,0)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu4y</span> = Y[<span style="color: #70c0b1;">len</span>(X)-1]

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">w</span> = 3
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">u</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu5</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu5y</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(2, <span style="color: #70c0b1;">len</span>(X)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu55</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (3* (<span style="color: #70c0b1;">len</span>(X)-1)) -4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.append(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> =( X[i-1]*2 )
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(u,b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> a == (X[1])*2:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a1</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(u,a1)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(u,a)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(w,-b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(w,-a)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu5.append(ecu55)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">u</span> = u+3
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">w</span> = w+3
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu5y.append(0)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu6</span> = [1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span>=(3*(<span style="color: #70c0b1;">len</span>(X)-1))-1 
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu6.append(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu6y</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">matriz</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">matrizy</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(ecu1)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu1[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu1y[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu2[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu2y[i])

<span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu3)
<span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu3y)

<span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu4)
<span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu4y)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(ecu5)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu5[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu5y[i])

<span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu6)
<span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu6y)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">imprimir la matriz resultante del sistema de ecuaciones</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #b9ca4a;">"""</span>
<span style="color: #b9ca4a; background-color: #2a2a2a;"> </span><span style="color: #b9ca4a;">   print(matriz)</span>
<span style="color: #b9ca4a; background-color: #2a2a2a;"> </span><span style="color: #b9ca4a;">   print("\nEl vector con los valores de y es:")</span>
<span style="color: #b9ca4a; background-color: #2a2a2a;"> </span><span style="color: #b9ca4a;">   print(matrizy)</span>
<span style="color: #b9ca4a; background-color: #2a2a2a;"> </span><span style="color: #b9ca4a;">   """</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">solucion</span> = np.linalg.solve(matriz, matrizy)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuaciones</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> x <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(0,<span style="color: #70c0b1;">len</span>(solucion),3):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = <span style="color: #b9ca4a;">""</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion +<span style="color: #70c0b1;">str</span>(solucion[x])+<span style="color: #b9ca4a;">"(X^2) "</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> solucion[x+1] &lt; 0:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion + <span style="color: #70c0b1;">str</span>(solucion[x+1]) + <span style="color: #b9ca4a;">"X "</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion +<span style="color: #b9ca4a;">"+"</span>+<span style="color: #70c0b1;">str</span>(solucion[x+1]) + <span style="color: #b9ca4a;">"X "</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> solucion[x+2] &lt; 0:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion + <span style="color: #70c0b1;">str</span>(solucion[x+2])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion +<span style="color: #b9ca4a;">"+"</span>+<span style="color: #70c0b1;">str</span>(solucion[x+2])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecuaciones.append(ecuacion)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> solucion, ecuaciones

<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Recive las listas de X de los puntos y la lista de la solucion de Xs de la matriz resultante de las ecuaciones y el valor de X a evaluar</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Retorna el valor de F de X a evaluar</span>
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">evaluar_cuadratico</span>(X,X2,X_eval):
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">j</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(X)-1):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = X[i]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = X[i+1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> X[i] &lt;= X_eval <span style="color: #c397d8;">and</span> X_eval &lt;= X[i+1]:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">G</span> = ( X2[j] ) * ( X_eval**2 ) + ( X2[j+1] ) * X_eval + (X2[j+2])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">j</span> = j+3
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> G

<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Recibe un vector de Xs y uno de Ys de los puntos a interpolar, y un valor de X a evaluar</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Retorna el valor de F de X a evaluar y una lista de strings con los polinomios</span>
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">mainCuadratico</span>(xs, ys, valor_evaluar):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">X2</span>, <span style="color: #e78c45;">ecuaciones</span> = spline_cuadratico(xs,ys)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">evaluacion</span> = evaluar_cuadratico(xs,X2,valor_evaluar)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> x <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(ecuaciones)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuaciones</span>[x] = ecuaciones[x] +<span style="color: #b9ca4a;">"    "</span>+<span style="color: #70c0b1;">str</span>(xs[x]) + <span style="color: #b9ca4a;">" &lt;= X &lt;= "</span> + <span style="color: #70c0b1;">str</span>(xs[x+1])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">imprimir ecuaciones</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(ecuaciones[x])

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">imprimir el valor de F de X a evaluar</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"&gt; Al evaluar"</span>,valor_evaluar, <span style="color: #b9ca4a;">"se obtiene:"</span>, evaluacion)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> evaluacion, ecuaciones

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = [-1,0,3,4]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">y</span> = [15.5,3,8,1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">valor</span> = 1

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">evaluacion</span>, <span style="color: #e78c45;">ecuaciones</span> = mainCuadratico(x,y,valor)

</pre>
</div>
<ul class="org-ul">
<li>Como ejecutarlo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">x</span> = [-1,0,3,4]
<span style="background-color: #2a2a2a;"> </span><span style="color: #e78c45;">y</span> = [15.5,3,8,1]
<span style="background-color: #2a2a2a;"> </span><span style="color: #e78c45;">valor</span> = 1

<span style="background-color: #2a2a2a;"> </span><span style="color: #e78c45;">evaluacion</span>, <span style="color: #e78c45;">ecuaciones</span> = mainCuadratico(x,y,valor)
</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
0.0(X^2) -12.499999999999972X +3.0000000000000284    -1 &lt;= X &lt;= 0
4.7222222222222126(X^2) -12.499999999999972X +3.0    0 &lt;= X &lt;= 3
-22.83333333333332(X^2) +152.83333333333326X -244.99999999999986    3 &lt;= X &lt;= 4
&gt; Al evaluar 1 se obtiene: -4.777777777777759

</pre>
</div>
</div>
<div id="outline-container-org4bfd353" class="outline-4">
<h4 id="org4bfd353"><span class="section-number-4">2.2.5</span> Trazadores cúbicos</h4>
<div class="outline-text-4" id="text-2-2-5">
<ul class="org-ul">
<li>Algoritmo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #c397d8;">import</span> numpy <span style="color: #c397d8;">as</span> np

<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Este metodo recive 2 listas, los X y los Y de los puntos</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Retornara una lista con los Xs resultantes de la matriz generada y una lista de strings con las ecuaciones resultantes</span>
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">spline_cubico</span>(X,Y):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">k</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu1</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu1y</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(2,<span style="color: #70c0b1;">len</span>(X)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu11</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = (X[i-1])**3
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = (X[i-1])**2
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">c</span> = (X[i-1])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">d</span> = 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">e</span> = Y[i-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (4* (<span style="color: #70c0b1;">len</span>(X)-1))-4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu11.append(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu11.insert(k,d)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu11.insert(k,c)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu11.insert(k,b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu11.insert(k,a)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu1.append(ecu11)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu1y.append(e)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">k</span> = k+4

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">k</span> = 4
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu2</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu2y</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(2,<span style="color: #70c0b1;">len</span>(X)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu22</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = (X[i-1])**3
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = (X[i-1])**2
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">c</span> = (X[i-1])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">d</span> = 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">e</span> = Y[i-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (4* (<span style="color: #70c0b1;">len</span>(X)-1))-4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu22.append(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu22.insert(k,d)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu22.insert(k,c)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu22.insert(k,b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu22.insert(k,a)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu2.append(ecu22)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu2y.append(e)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">k</span> = k+4

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu3</span> = [ X[0]**3, X[0]**2, X[0], 1 ]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (4* (<span style="color: #70c0b1;">len</span>(X)-1)) - <span style="color: #70c0b1;">len</span>(ecu3)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu3.append(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu3y</span>=Y[0]

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = X[<span style="color: #70c0b1;">len</span>(X)-1]**3
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = X[<span style="color: #70c0b1;">len</span>(X)-1]**2
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">c</span> = X[<span style="color: #70c0b1;">len</span>(X)-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu4</span>=[a,b,c,1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (4*(<span style="color: #70c0b1;">len</span>(X)-1)) - <span style="color: #70c0b1;">len</span>(ecu4)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu4.insert(0,0)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu4y</span> = Y[<span style="color: #70c0b1;">len</span>(X)-1]

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">w</span> = 4
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">u</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu5</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu5y</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(2, <span style="color: #70c0b1;">len</span>(X)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu55</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (4* (<span style="color: #70c0b1;">len</span>(X)-1)) -6
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.append(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> =( X[i-1]**2 )*3
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = X[i-1]*2
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">c</span> = 1
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(u,c)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(u,b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(u,a)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(w,-c)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(w,-b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu55.insert(w,-a)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu5.append(ecu55)

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">u</span> = u+4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">w</span> = w+4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu5y.append(0)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">w</span> = 4
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">u</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu6</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu6y</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(2, <span style="color: #70c0b1;">len</span>(X)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu66</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = X[i-1]*6
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = 2
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (4* (<span style="color: #70c0b1;">len</span>(X)-1)) -4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu66.append(0)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu66.insert(u,b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu66.insert(u,a)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu66.insert(w,-b)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu66.insert(w,-a)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu6.append(ecu66)
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">u</span> = u+4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">w</span> = w+4
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu6y.append(0)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = 6 * X[0]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = 2
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu7</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = ( 4*(<span style="color: #70c0b1;">len</span>(X)-1) ) -2
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu7.append(0)
<span style="background-color: #2a2a2a;"> </span>   ecu7.insert(0,b)
<span style="background-color: #2a2a2a;"> </span>   ecu7.insert(0,a)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu7y</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = 6*X[<span style="color: #70c0b1;">len</span>(X)-1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = 2
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">w</span> = 4 * (<span style="color: #70c0b1;">len</span>(X)-2)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu8</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">p</span> = (4*(<span style="color: #70c0b1;">len</span>(X)-1)) -2
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> k <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(p):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecu8.append(0)
<span style="background-color: #2a2a2a;"> </span>   ecu8.insert(w,b)
<span style="background-color: #2a2a2a;"> </span>   ecu8.insert(w,a)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecu8y</span> = 0

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">matriz</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">matrizy</span> = []

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(ecu1)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu1[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu1y[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu2[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu2y[i])

<span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu3)
<span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu3y)

<span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu4)
<span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu4y)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(ecu5)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu5[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu5y[i])

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(ecu6)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu6[i])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu6y[i])

<span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu7)
<span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu7y)

<span style="background-color: #2a2a2a;"> </span>   matriz.append(ecu8)
<span style="background-color: #2a2a2a;"> </span>   matrizy.append(ecu8y)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">imprimir la matriz resultante del sistema de ecuaciones</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #b9ca4a;">"""</span>
<span style="color: #b9ca4a; background-color: #2a2a2a;"> </span><span style="color: #b9ca4a;">   print(matriz)</span>
<span style="color: #b9ca4a; background-color: #2a2a2a;"> </span><span style="color: #b9ca4a;">   print("\nEl vector con los valores de y es:")</span>
<span style="color: #b9ca4a; background-color: #2a2a2a;"> </span><span style="color: #b9ca4a;">   print(matrizy)</span>
<span style="color: #b9ca4a; background-color: #2a2a2a;"> </span><span style="color: #b9ca4a;">   """</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">solucion</span> = np.linalg.solve(matriz, matrizy)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuaciones</span> = []
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> x <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(0,<span style="color: #70c0b1;">len</span>(solucion),4):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = <span style="color: #b9ca4a;">""</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion +<span style="color: #70c0b1;">str</span>(solucion[x])+<span style="color: #b9ca4a;">"(X^3) "</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> solucion[x+1] &lt; 0:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion + <span style="color: #70c0b1;">str</span>(solucion[x+1]) + <span style="color: #b9ca4a;">"(X^2) "</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion +<span style="color: #b9ca4a;">"+"</span>+<span style="color: #70c0b1;">str</span>(solucion[x+1]) + <span style="color: #b9ca4a;">"(X^2) "</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> solucion[x+2] &lt; 0:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion + <span style="color: #70c0b1;">str</span>(solucion[x+2]) + <span style="color: #b9ca4a;">"X "</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion +<span style="color: #b9ca4a;">"+"</span>+<span style="color: #70c0b1;">str</span>(solucion[x+2]) + <span style="color: #b9ca4a;">"X "</span>

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> solucion[x+3] &lt; 0:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion + <span style="color: #70c0b1;">str</span>(solucion[x+3])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">else</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuacion</span> = ecuacion +<span style="color: #b9ca4a;">"+"</span>+<span style="color: #70c0b1;">str</span>(solucion[x+3])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   ecuaciones.append(ecuacion)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> solucion, ecuaciones

<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Recive las listas de X de los puntos y la lista de la solucion de Xs de la matriz resultante de las ecuaciones y el valor de X a evaluar</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Retorna el valor de F de X a evaluar</span>
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">evaluar_cubico</span>(X,X2,X_eval):
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">j</span> = 0
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> i <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(X)-1):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">a</span> = X[i]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">b</span> = X[i+1]
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">if</span> X[i] &lt;= X_eval <span style="color: #c397d8;">and</span> X_eval &lt;= X[i+1]:
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">G</span> = ( X2[j] ) * (X_eval**3) + (X2[j+1]) * (X_eval**2) + (X2[j+2]) * X_eval + (X2[j+3])
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">j</span> = j+4
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> G

<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Recibe un vector de Xs y uno de Ys de los puntos a interpolar, y un valor de X a evaluar</span>
<span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">Retorna el valor de F de X a evaluar y una lista de strings con los polinomios</span>
<span style="color: #c397d8;">def</span> <span style="color: #7aa6da;">mainCubico</span>(xs, ys, valor_evaluar):

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">X2</span>, <span style="color: #e78c45;">ecuaciones</span> = spline_cubico(xs,ys)
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">evaluacion</span> = evaluar_cubico(xs,X2,valor_evaluar)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">for</span> x <span style="color: #c397d8;">in</span> <span style="color: #70c0b1;">range</span>(<span style="color: #70c0b1;">len</span>(ecuaciones)):
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">ecuaciones</span>[x] = ecuaciones[x] +<span style="color: #b9ca4a;">"    "</span>+<span style="color: #70c0b1;">str</span>(xs[x]) + <span style="color: #b9ca4a;">" &lt;= X &lt;= "</span> + <span style="color: #70c0b1;">str</span>(xs[x+1])

<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">imprimir ecuaciones</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(ecuaciones[x])

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">imprimir el valor de F de X a evaluar</span>
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">print</span>(<span style="color: #b9ca4a;">"&gt; Al evaluar"</span>,valor_evaluar, <span style="color: #b9ca4a;">"se obtiene:"</span>, evaluacion)

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #c397d8;">return</span> evaluacion, ecuaciones

<span style="color: #c397d8;">if</span> <span style="color: #70c0b1;">__name__</span> == <span style="color: #b9ca4a;">"__main__"</span>:
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">x</span> = [-1,0,3,4]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">y</span> = [15.5,3,8,1]
<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">valor</span> = 1

<span style="background-color: #2a2a2a;"> </span>   <span style="color: #e78c45;">evaluacion</span>, <span style="color: #e78c45;">ecuaciones</span> = mainCubico(x,y,valor)

</pre>
</div>
<ul class="org-ul">
<li>Como ejecutarlo</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e78c45;">x</span> = [-1,0,3,4]
<span style="color: #e78c45;">y</span> = [15.5,3,8,1]
<span style="color: #e78c45;">valor</span> = 1

<span style="color: #e78c45;">evaluacion</span>, <span style="color: #e78c45;">ecuaciones</span> = mainCubico(x,y,valor)
</pre>
</div>
<ul class="org-ul">
<li>Resultado</li>
</ul>
<pre class="example">
2.5333333333333337(X^3) +7.600000000000001(X^2) -7.433333333333334X +2.9999999999999982    -1 &lt;= X &lt;= 0
-1.5222222222222226(X^3) +7.600000000000001(X^2) -7.433333333333333X +3.0    0 &lt;= X &lt;= 3
2.0333333333333323(X^3) -24.39999999999999(X^2) +88.56666666666665X -92.99999999999999    3 &lt;= X &lt;= 4
&gt; Al evaluar 1 se obtiene: 1.6444444444444466
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Jhon, Samuel, Alejandro</p>
<p class="date">Created: 2020-11-11 mié 22:04</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
